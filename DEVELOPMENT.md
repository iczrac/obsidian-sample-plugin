# å¼€å‘æŒ‡å—

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒè®¾ç½®

### å‰ç½®è¦æ±‚
- Node.js >= 16.0.0
- npm æˆ– yarn
- Obsidian åº”ç”¨ç¨‹åº

### å®‰è£…æ­¥éª¤
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/bazi-obsidian/bazi-plugin.git
cd bazi-plugin

# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

### å¼€å‘ç¯å¢ƒé…ç½®
1. å°†é¡¹ç›®é“¾æ¥åˆ° Obsidian æ’ä»¶ç›®å½•
```bash
# åˆ›å»ºè½¯é“¾æ¥
ln -s /path/to/bazi-plugin /path/to/vault/.obsidian/plugins/bazi-obsidian
```

2. åœ¨ Obsidian ä¸­å¯ç”¨æ’ä»¶
3. ä¿®æ”¹ä»£ç åè‡ªåŠ¨é‡æ–°åŠ è½½

## ğŸ“ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main.ts                 # æ’ä»¶å…¥å£
â”œâ”€â”€ bazi/                   # å…«å­—è®¡ç®—æ ¸å¿ƒ
â”‚   â”œâ”€â”€ calculator.ts       # å…«å­—è®¡ç®—å™¨
â”‚   â””â”€â”€ types.ts           # ç±»å‹å®šä¹‰
â”œâ”€â”€ commands/               # å‘½ä»¤ç®¡ç†
â”‚   â””â”€â”€ CommandManager.ts   # å‘½ä»¤æ³¨å†Œå™¨
â”œâ”€â”€ components/             # Svelteç»„ä»¶
â”‚   â”œâ”€â”€ BaziShenShaDetail.svelte
â”‚   â””â”€â”€ ShenShaDetailModal.svelte
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ WuXingConfig.ts     # äº”è¡Œé…ç½®
â”œâ”€â”€ parser/                 # è§£æå™¨
â”‚   â””â”€â”€ dateParser.ts       # æ—¥æœŸè§£æ
â”œâ”€â”€ processors/             # å¤„ç†å™¨
â”‚   â””â”€â”€ CodeBlockProcessor.ts # ä»£ç å—å¤„ç†
â”œâ”€â”€ services/               # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ BaziService.ts      # å…«å­—æœåŠ¡
â”‚   â”œâ”€â”€ ShenShaService.ts   # ç¥ç…æœåŠ¡
â”‚   â”œâ”€â”€ GeJuService.ts      # æ ¼å±€æœåŠ¡
â”‚   â””â”€â”€ WuXingService.ts    # äº”è¡ŒæœåŠ¡
â”œâ”€â”€ settings/               # è®¾ç½®ç®¡ç†
â”‚   â””â”€â”€ PluginSettings.ts   # æ’ä»¶è®¾ç½®
â”œâ”€â”€ types/                  # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ BaziInfo.ts         # å…«å­—ä¿¡æ¯ç±»å‹
â”‚   â””â”€â”€ PluginTypes.ts      # æ’ä»¶ç±»å‹
â””â”€â”€ ui/                     # UIç»„ä»¶
    â”œâ”€â”€ BaziView.ts         # å…«å­—è§†å›¾
    â”œâ”€â”€ SimpleBaziView.ts   # ç®€å•è§†å›¾
    â”œâ”€â”€ StandardBaziView.ts # æ ‡å‡†è§†å›¾
    â””â”€â”€ InteractiveBaziView.ts # äº¤äº’è§†å›¾
```

## ğŸ”§ æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. BaziService (å…«å­—æœåŠ¡)
è´Ÿè´£å…«å­—è®¡ç®—çš„æ ¸å¿ƒé€»è¾‘ï¼š
- å…¬å†/å†œå†æ—¥æœŸè½¬æ¢
- å››æŸ±å…«å­—è®¡ç®—
- è—å¹²ã€çº³éŸ³è®¡ç®—
- äº”è¡Œå¼ºåº¦åˆ†æ

### 2. ShenShaService (ç¥ç…æœåŠ¡)
å¤„ç†30ç§ç¥ç…çš„è®¡ç®—ï¼š
- åŸºäºä¸åŒä¾æ®çš„ç¥ç…è®¡ç®—
- ç¥ç…ç»„åˆåˆ†æ
- ç¥ç…è¯¦æƒ…æŸ¥è¯¢

### 3. CodeBlockProcessor (ä»£ç å—å¤„ç†å™¨)
å¤„ç† Obsidian ä¸­çš„ bazi ä»£ç å—ï¼š
- å‚æ•°è§£æ
- è§†å›¾æ¸²æŸ“
- äº¤äº’äº‹ä»¶å¤„ç†

### 4. UIç»„ä»¶ç³»ç»Ÿ
ä¸‰ç§æ˜¾ç¤ºæ ·å¼çš„å®ç°ï¼š
- SimpleBaziView: ç®€æ´æ˜¾ç¤º
- StandardBaziView: æ ‡å‡†æ˜¾ç¤º
- InteractiveBaziView: å®Œæ•´äº¤äº’

## ğŸ¨ æ ·å¼å¼€å‘

### CSS æ¶æ„
```css
/* åŸºç¡€æ ·å¼ */
.bazi-view-container { }

/* ç®€å•æ ·å¼ */
.simple-bazi-view { }

/* æ ‡å‡†æ ·å¼ */
.standard-bazi-view { }

/* äº”è¡Œé¢œè‰²ç³»ç»Ÿ */
.wuxing-jin { color: #FFD700; }
.wuxing-mu { color: #228B22; }
.wuxing-shui { color: #1E90FF; }
.wuxing-huo { color: #FF4500; }
.wuxing-tu { color: #8B4513; }
```

### å“åº”å¼è®¾è®¡
- ä½¿ç”¨ CSS Grid å’Œ Flexbox
- æ”¯æŒæš—è‰²/äº®è‰²ä¸»é¢˜
- ç§»åŠ¨ç«¯é€‚é…

## ğŸ§ª æµ‹è¯•æŒ‡å—

### å•å…ƒæµ‹è¯•
```bash
# è¿è¡Œæµ‹è¯•
npm test

# æµ‹è¯•è¦†ç›–ç‡
npm run test:coverage
```

### æ‰‹åŠ¨æµ‹è¯•
1. åˆ›å»ºæµ‹è¯•ç”¨ä¾‹ä»£ç å—
2. éªŒè¯ä¸åŒå‚æ•°ç»„åˆ
3. æ£€æŸ¥UIäº¤äº’åŠŸèƒ½
4. æµ‹è¯•é”™è¯¯å¤„ç†

### æµ‹è¯•ç”¨ä¾‹ç¤ºä¾‹
```markdown
```bazi
date: 1990-01-01 08:00
gender: ç”·
style: 3
```

```bazi
bazi: åºšåˆ æˆŠå­ ä¹™å¯ è¾›å·³
```

```bazi
lunar: å†œå†1989å¹´åä¸€æœˆå»¿äº”æ—¥è¾°æ—¶
gender: å¥³
```

## ğŸš€ å‘å¸ƒæµç¨‹

### ç‰ˆæœ¬ç®¡ç†
1. æ›´æ–° `manifest.json` ä¸­çš„ç‰ˆæœ¬å·
2. æ›´æ–° `package.json` ä¸­çš„ç‰ˆæœ¬å·
3. æ›´æ–° `versions.json` æ–‡ä»¶

### æ„å»ºå‘å¸ƒ
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# è¿è¡Œå‘å¸ƒè„šæœ¬
npm run deploy
```

### å‘å¸ƒæ£€æŸ¥æ¸…å•
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] ä»£ç è´¨é‡æ£€æŸ¥
- [ ] æ–‡æ¡£æ›´æ–°å®Œæ•´
- [ ] ç‰ˆæœ¬å·æ­£ç¡®
- [ ] æ„å»ºæ— é”™è¯¯

## ğŸ› è°ƒè¯•æŠ€å·§

### å¼€å‘è€…å·¥å…·
- ä½¿ç”¨ Obsidian å¼€å‘è€…æ§åˆ¶å°
- å¯ç”¨æ’ä»¶è°ƒè¯•æ¨¡å¼
- æŸ¥çœ‹ç½‘ç»œè¯·æ±‚å’Œé”™è¯¯æ—¥å¿—

### å¸¸è§é—®é¢˜
1. **æ’ä»¶ä¸åŠ è½½**: æ£€æŸ¥ manifest.json æ ¼å¼
2. **æ ·å¼å¼‚å¸¸**: æ£€æŸ¥ CSS é€‰æ‹©å™¨ä¼˜å…ˆçº§
3. **è®¡ç®—é”™è¯¯**: éªŒè¯ lunar-typescript ç‰ˆæœ¬

### æ—¥å¿—ç³»ç»Ÿ
```typescript
// åœ¨è®¾ç½®ä¸­å¯ç”¨è°ƒè¯•æ¨¡å¼
if (this.plugin.settings.debugMode) {
    console.log('è°ƒè¯•ä¿¡æ¯:', data);
}
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
- éµå¾ª ESLint é…ç½®
- ä¿æŒä»£ç æ³¨é‡Šå®Œæ•´

### æäº¤è§„èŒƒ
```
feat: æ·»åŠ æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ›´æ–°æ–‡æ¡£
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
test: æ·»åŠ æµ‹è¯•
chore: æ„å»ºå·¥å…·æ›´æ–°
```

### Pull Request æµç¨‹
1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤ä»£ç 
4. åˆ›å»º PR
5. ä»£ç å®¡æŸ¥
6. åˆå¹¶ä¸»åˆ†æ”¯
