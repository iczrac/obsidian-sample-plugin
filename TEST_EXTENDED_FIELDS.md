# 🧪 扩展字段测试文档

## 📋 **测试步骤**

### **1. 重启Obsidian**
- 完全关闭Obsidian
- 重新打开Obsidian
- 确保插件已启用

### **2. 检查插件设置**
- 打开 设置 → 插件选项 → 八字命盘
- 查看是否有 "双链和标签设置" 标签页
- 检查字段数量是否正确

### **3. 测试地名字段**

#### **测试用例1：现代城市**
```bazi
date: 1990-01-01 08:00
gender: 男
name: 张三
note: 出生地北京，工作地深圳，居住地杭州
```

**期望生成的双链：**
- `[[张三]]`
- `[[出生地]]`
- `[[北京]]`
- `[[工作地]]`
- `[[深圳]]`
- `[[居住地]]`
- `[[杭州]]`

#### **测试用例2：历史地名**
```bazi
date: 1850-01-01 08:00
gender: 男
name: 李四
note: 籍贯江南，长安求学，金陵居住
```

**期望生成的双链：**
- `[[李四]]`
- `[[籍贯]]`
- `[[江南]]`
- `[[长安]]`
- `[[金陵]]`

### **4. 测试书籍字段**

#### **测试用例3：经典命理典籍**
```bazi
date: 1980-01-01 08:00
gender: 女
name: 王五
note: 参考滴天髓和子平真诠的理论，结合穷通宝鉴的方法
```

**期望生成的双链：**
- `[[王五]]`
- `[[滴天髓]]`
- `[[子平真诠]]`
- `[[穷通宝鉴]]`

#### **测试用例4：现代命理著作**
```bazi
date: 1975-01-01 08:00
gender: 男
name: 赵六
note: 根据八字预测真踪和四柱预测学的观点分析
```

**期望生成的双链：**
- `[[赵六]]`
- `[[八字预测真踪]]`
- `[[四柱预测学]]`

## 🔍 **字段数量检查**

### **地名字段应该包含：**

#### **地理概念 (7个)**
```
出生地、籍贯、居住地、工作地、祖籍、故乡、家乡
```

#### **直辖市 (4个)**
```
北京、上海、天津、重庆
```

#### **省会城市 (21个)**
```
广州、深圳、杭州、南京、武汉、成都、西安、郑州、
济南、沈阳、长春、哈尔滨、石家庄、太原、呼和浩特、
南昌、长沙、福州、厦门、南宁、海口、昆明、贵阳、
拉萨、兰州、西宁、银川、乌鲁木齐
```

#### **港澳台 (4个)**
```
香港、澳门、台北、台湾
```

#### **历史地名 (7个)**
```
京城、金陵、临安、长安、洛阳、开封、应天府
```

#### **地区概念 (12个)**
```
江南、江北、华北、华南、东北、西北、西南、华中、
中原、关中、江淮、岭南、塞北、关外
```

**地名字段总计：55个**

### **书籍字段应该包含：**

#### **经典四柱命理典籍 (8个)**
```
滴天髓、子平真诠、穷通宝鉴、三命通会、
渊海子平、神峰通考、命理探源、五行精纪
```

#### **古代命理经典 (11个)**
```
珞琭子赋、李虚中命书、兰台妙选、玉照定真经、
碧渊赋、金声玉振赋、继善篇、爱憎赋、
一行禅师天元歌、鬼谷子分定经、李虚中命书
```

#### **现代命理著作 (8个)**
```
八字真诠、命理约言、滴天髓征义、子平粹言、
命理新论、八字预测真踪、四柱预测学、八字命理学
```

#### **相关典籍 (9个)**
```
易经、周易、黄帝内经、奇门遁甲、紫微斗数、
六壬大全、太乙神数、铁板神数、邵子神数
```

#### **历代名家著作 (8个)**
```
徐子平集、万民英集、张楠集、沈孝瞻集、
任铁樵集、袁树珊集、韦千里集、梁湘润集
```

**书籍字段总计：44个**

## 🔧 **故障排除**

### **如果看不到扩展字段：**

#### **1. 检查插件版本**
- 确认插件已更新到最新版本
- 检查main.js文件的修改时间

#### **2. 清除缓存**
- 关闭Obsidian
- 删除 `.obsidian/plugins/bazi-chart/` 文件夹中的缓存文件
- 重新启动Obsidian

#### **3. 重新安装插件**
- 禁用插件
- 重新启用插件
- 检查设置是否恢复

#### **4. 检查控制台错误**
- 按F12打开开发者工具
- 查看Console标签页是否有错误信息
- 如有错误，请提供错误信息

### **如果设置界面显示字段数量不正确：**

#### **检查显示的数量：**
- **地名相关**：应显示 "(55 个字段)"
- **书籍典籍**：应显示 "(44 个字段)"

#### **如果数量不对：**
1. 检查源文件是否正确更新
2. 重新构建项目：`npm run build`
3. 重启Obsidian

## 📊 **验证方法**

### **方法1：查看设置界面**
1. 打开插件设置
2. 进入"双链和标签设置"标签页
3. 查看"地名相关"和"书籍典籍"的字段数量

### **方法2：测试实际功能**
1. 创建包含扩展字段的八字
2. 点击工具栏的"🔗 相关链接"按钮
3. 查看是否生成了相应的双链

### **方法3：检查配置文件**
1. 打开开发者工具
2. 在Console中输入：
```javascript
app.plugins.plugins['bazi-chart'].doubleLinkTagSettingsManager.getGlobalSettings()
```
3. 查看返回的配置对象

## 💡 **预期结果**

如果扩展字段正常工作，您应该能看到：

1. **设置界面**显示正确的字段数量
2. **测试八字**能生成相应的双链
3. **配置对象**包含所有扩展字段

如果仍然看不到扩展字段，请告诉我具体的情况，我会进一步帮您排查问题。
