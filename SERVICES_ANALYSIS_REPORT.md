# æœåŠ¡æ¶æ„åˆ†æä¸é‡æ„å»ºè®®æŠ¥å‘Š

## ğŸ“Š **å½“å‰æœåŠ¡æ¶æ„åˆ†æ**

### **ä¸»æœåŠ¡å±‚ (src/services/)**

| æœåŠ¡æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ | é—®é¢˜ |
|----------|------|------|------|------|
| **BaziService.ts** | 569è¡Œ | å…«å­—æ ¸å¿ƒæœåŠ¡ | âœ… è‰¯å¥½ | å·²ç²¾ç®€ï¼ŒèŒè´£æ¸…æ™° |
| **GeJuService.ts** | 773è¡Œ | æ ¼å±€è§£é‡ŠæœåŠ¡ | âš ï¸ é‡å¤ | ä¸bazi/GeJuCalculatoré‡å¤ |
| **ShenShaService.ts** | 1152è¡Œ | ç¥ç…è§£é‡ŠæœåŠ¡ | âš ï¸ é‡å¤ | ä¸baziç¥ç…è®¡ç®—å™¨é‡å¤ |
| **GeJuJudgeService.ts** | ?è¡Œ | æ ¼å±€åˆ¤æ–­æœåŠ¡ | â“ æœªçŸ¥ | éœ€è¦æ£€æŸ¥ |
| **GeJuTrendService.ts** | ?è¡Œ | æ ¼å±€è¶‹åŠ¿æœåŠ¡ | â“ æœªçŸ¥ | éœ€è¦æ£€æŸ¥ |
| **WuXingService.ts** | ?è¡Œ | äº”è¡ŒæœåŠ¡ | â“ æœªçŸ¥ | éœ€è¦æ£€æŸ¥ |
| **DynastyService.ts** | ?è¡Œ | æœä»£æœåŠ¡ | â“ æœªçŸ¥ | éœ€è¦æ£€æŸ¥ |
| **LinkService.ts** | ?è¡Œ | é“¾æ¥æœåŠ¡ | â“ æœªçŸ¥ | éœ€è¦æ£€æŸ¥ |
| **TagService.ts** | ?è¡Œ | æ ‡ç­¾æœåŠ¡ | â“ æœªçŸ¥ | éœ€è¦æ£€æŸ¥ |

### **è®¡ç®—å™¨å±‚ (src/services/bazi/)**

| è®¡ç®—å™¨æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ | é—®é¢˜ |
|------------|------|------|------|------|
| **BaziCalculator.ts** | ?è¡Œ | åŸºç¡€å…«å­—è®¡ç®— | âœ… è‰¯å¥½ | æ ¸å¿ƒè®¡ç®—å™¨ |
| **ShiShenCalculator.ts** | ?è¡Œ | åç¥è®¡ç®— | âœ… è‰¯å¥½ | ä¸“ä¸šåŒ– |
| **ShenShaCalculator.ts** | 494è¡Œ | åŸºç¡€ç¥ç…æ–¹æ³• | âœ… è‰¯å¥½ | åŸºç¡€æ–¹æ³•åº“ |
| **ComprehensiveShenShaCalculator.ts** | 300è¡Œ | ç»¼åˆç¥ç…è®¡ç®— | âœ… è‰¯å¥½ | æ–°å¢ï¼ŒåŠŸèƒ½å®Œæ•´ |
| **SpecialShenShaCalculator.ts** | 300è¡Œ | ç‰¹æ®Šç¥ç…è®¡ç®— | âœ… è‰¯å¥½ | æ–°å¢ï¼Œä¸“ä¸šåŒ– |
| **GeJuCalculator.ts** | 300è¡Œ | æ ¼å±€è®¡ç®— | âœ… è‰¯å¥½ | æ–°å¢ï¼Œä¸“ä¸šåŒ– |
| **DaYunCalculator.ts** | 201è¡Œ | å¤§è¿è®¡ç®— | âœ… è‰¯å¥½ | ä¸“ä¸šåŒ– |
| **LiuNianCalculator.ts** | 246è¡Œ | æµå¹´è®¡ç®— | âœ… è‰¯å¥½ | ä¸“ä¸šåŒ– |
| **XunKongCalculator.ts** | 203è¡Œ | æ—¬ç©ºè®¡ç®— | âœ… è‰¯å¥½ | ä¸“ä¸šåŒ– |
| **YearMatchCalculator.ts** | 204è¡Œ | å¹´ä»½åŒ¹é…è®¡ç®— | âœ… è‰¯å¥½ | ä¸“ä¸šåŒ– |
| **CombinationCalculator.ts** | ?è¡Œ | ç»„åˆè®¡ç®— | âœ… è‰¯å¥½ | ä¸“ä¸šåŒ– |
| **WuXingStrengthCalculator.ts** | ?è¡Œ | äº”è¡Œå¼ºåº¦è®¡ç®— | âœ… è‰¯å¥½ | ä¸“ä¸šåŒ– |
| **BaziHTMLRenderer.ts** | ?è¡Œ | HTMLæ¸²æŸ“ | âœ… è‰¯å¥½ | ä¸“ä¸šåŒ– |
| **BaziUtils.ts** | ?è¡Œ | å·¥å…·æ–¹æ³• | âœ… è‰¯å¥½ | å·¥å…·åº“ |
| **ShenShaExtended.ts** | 248è¡Œ | æ‰©å±•ç¥ç… | âŒ åºŸå¼ƒ | å·²æ ‡è®°åºŸå¼ƒ |

## ğŸš¨ **å‘ç°çš„é‡å¤å’Œå†—ä½™é—®é¢˜**

### **1. æ ¼å±€æœåŠ¡é‡å¤**
- **GeJuService.ts** (773è¡Œ) - æä¾›æ ¼å±€è§£é‡Šå’Œåˆ†æ
- **bazi/GeJuCalculator.ts** (300è¡Œ) - æä¾›æ ¼å±€è®¡ç®—
- **GeJuJudgeService.ts** - å¯èƒ½æä¾›æ ¼å±€åˆ¤æ–­
- **GeJuTrendService.ts** - å¯èƒ½æä¾›æ ¼å±€è¶‹åŠ¿

**é—®é¢˜**: åŠŸèƒ½é‡å ï¼ŒèŒè´£ä¸æ¸…

### **2. ç¥ç…æœåŠ¡é‡å¤**
- **ShenShaService.ts** (1152è¡Œ) - æä¾›ç¥ç…è§£é‡Š
- **bazi/ShenShaCalculator.ts** (494è¡Œ) - åŸºç¡€ç¥ç…æ–¹æ³•
- **bazi/ComprehensiveShenShaCalculator.ts** (300è¡Œ) - ç»¼åˆç¥ç…è®¡ç®—
- **bazi/SpecialShenShaCalculator.ts** (300è¡Œ) - ç‰¹æ®Šç¥ç…è®¡ç®—

**é—®é¢˜**: åŠŸèƒ½é‡å ï¼Œæ•°æ®é‡å¤

### **3. äº”è¡ŒæœåŠ¡å¯èƒ½é‡å¤**
- **WuXingService.ts** - å¯èƒ½æä¾›äº”è¡ŒæœåŠ¡
- **bazi/WuXingStrengthCalculator.ts** - äº”è¡Œå¼ºåº¦è®¡ç®—
- **bazi/BaziUtils.ts** - åŒ…å«äº”è¡Œå·¥å…·æ–¹æ³•

**é—®é¢˜**: å¯èƒ½å­˜åœ¨åŠŸèƒ½é‡å 

## ğŸ¯ **é‡æ„å»ºè®®**

### **é˜¶æ®µä¸€ï¼šæœåŠ¡åˆ†å±‚é‡æ„**

#### **1. è®¡ç®—å±‚ (Calculation Layer)**
```
src/services/bazi/
â”œâ”€â”€ æ ¸å¿ƒè®¡ç®—å™¨ (ä¿æŒ)
â”œâ”€â”€ BaziCalculator.ts
â”œâ”€â”€ ShiShenCalculator.ts  
â”œâ”€â”€ ShenShaCalculator.ts
â”œâ”€â”€ ComprehensiveShenShaCalculator.ts
â”œâ”€â”€ SpecialShenShaCalculator.ts
â”œâ”€â”€ GeJuCalculator.ts
â”œâ”€â”€ DaYunCalculator.ts
â”œâ”€â”€ LiuNianCalculator.ts
â”œâ”€â”€ WuXingStrengthCalculator.ts
â””â”€â”€ BaziUtils.ts
```

#### **2. ä¸šåŠ¡æœåŠ¡å±‚ (Business Service Layer)**
```
src/services/
â”œâ”€â”€ BaziService.ts (ä¸»æœåŠ¡ï¼Œä¿æŒ)
â”œâ”€â”€ è§£é‡ŠæœåŠ¡ (é‡æ„)
â”œâ”€â”€ GeJuExplanationService.ts (åˆå¹¶GeJuService)
â”œâ”€â”€ ShenShaExplanationService.ts (åˆå¹¶ShenShaService)
â”œâ”€â”€ WuXingExplanationService.ts (æ–°å¢)
â””â”€â”€ è¾…åŠ©æœåŠ¡ (æ£€æŸ¥åå†³å®š)
```

#### **3. å±•ç¤ºå±‚ (Presentation Layer)**
```
src/services/presentation/
â”œâ”€â”€ BaziHTMLRenderer.ts (ç§»åŠ¨)
â”œâ”€â”€ GeJuRenderer.ts (æ–°å¢)
â”œâ”€â”€ ShenShaRenderer.ts (æ–°å¢)
â””â”€â”€ ReportGenerator.ts (æ–°å¢)
```

### **é˜¶æ®µäºŒï¼šå…·ä½“é‡æ„æ–¹æ¡ˆ**

#### **1. æ ¼å±€æœåŠ¡é‡æ„**
```typescript
// æ–°çš„æ ¼å±€è§£é‡ŠæœåŠ¡
export class GeJuExplanationService {
  // åˆå¹¶GeJuServiceçš„è§£é‡ŠåŠŸèƒ½
  static getGeJuExplanation(geJu: string): GeJuExplanation
  static analyzeGeJu(geJu: string, context: BaziContext): GeJuAnalysis
  static getGeJuAdvice(geJu: string): GeJuAdvice
}

// æ ¼å±€è®¡ç®—ä¿æŒåœ¨bazi/GeJuCalculator.ts
```

#### **2. ç¥ç…æœåŠ¡é‡æ„**
```typescript
// æ–°çš„ç¥ç…è§£é‡ŠæœåŠ¡
export class ShenShaExplanationService {
  // åˆå¹¶ShenShaServiceçš„è§£é‡ŠåŠŸèƒ½
  static getShenShaExplanation(shenSha: string): ShenShaExplanation
  static getShenShaAdvice(shenSha: string): ShenShaAdvice
  static analyzeShenShaCombination(shenShaList: string[]): CombinationAnalysis
}

// ç¥ç…è®¡ç®—ä¿æŒåœ¨bazi/ç›®å½•ä¸‹
```

#### **3. äº”è¡ŒæœåŠ¡æ•´åˆ**
```typescript
// æ–°çš„äº”è¡Œè§£é‡ŠæœåŠ¡
export class WuXingExplanationService {
  static getWuXingExplanation(wuXing: string): WuXingExplanation
  static analyzeWuXingBalance(wuXingData: WuXingData): BalanceAnalysis
  static getWuXingAdvice(wuXingData: WuXingData): WuXingAdvice
}

// äº”è¡Œè®¡ç®—ä¿æŒåœ¨bazi/WuXingStrengthCalculator.ts
```

### **é˜¶æ®µä¸‰ï¼šåˆ é™¤å†—ä½™æ–‡ä»¶**

#### **éœ€è¦åˆ é™¤çš„æ–‡ä»¶**
1. **ShenShaExtended.ts** - å·²æ ‡è®°åºŸå¼ƒ
2. **å¯èƒ½é‡å¤çš„æœåŠ¡æ–‡ä»¶** (éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥)

#### **éœ€è¦åˆå¹¶çš„æ–‡ä»¶**
1. **GeJuService.ts** â†’ **GeJuExplanationService.ts**
2. **ShenShaService.ts** â†’ **ShenShaExplanationService.ts**

## ğŸ“‹ **å®æ–½è®¡åˆ’**

### **ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥æœªçŸ¥æœåŠ¡**
```bash
# æ£€æŸ¥ä»¥ä¸‹æ–‡ä»¶çš„åŠŸèƒ½å’Œé‡å¤æ€§
- GeJuJudgeService.ts
- GeJuTrendService.ts  
- WuXingService.ts
- DynastyService.ts
- LinkService.ts
- TagService.ts
```

### **ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ–°çš„è§£é‡ŠæœåŠ¡**
1. åˆ›å»ºGeJuExplanationService.ts
2. åˆ›å»ºShenShaExplanationService.ts
3. åˆ›å»ºWuXingExplanationService.ts

### **ç¬¬ä¸‰æ­¥ï¼šè¿ç§»åŠŸèƒ½**
1. å°†è§£é‡ŠåŠŸèƒ½ä»æ—§æœåŠ¡è¿ç§»åˆ°æ–°æœåŠ¡
2. æ›´æ–°BaziServiceçš„ä¾èµ–å…³ç³»
3. æ›´æ–°å‰ç«¯è°ƒç”¨

### **ç¬¬å››æ­¥ï¼šåˆ é™¤å†—ä½™**
1. åˆ é™¤æ—§çš„æœåŠ¡æ–‡ä»¶
2. åˆ é™¤åºŸå¼ƒçš„æ–‡ä»¶
3. æ¸…ç†æœªä½¿ç”¨çš„å¯¼å…¥

### **ç¬¬äº”æ­¥ï¼šæµ‹è¯•éªŒè¯**
1. è¿è¡Œæ„å»ºæµ‹è¯•
2. éªŒè¯åŠŸèƒ½å®Œæ•´æ€§
3. æ£€æŸ¥æ€§èƒ½å½±å“

## ğŸŠ **é¢„æœŸæ”¶ç›Š**

### **ä»£ç è´¨é‡æå‡**
- âœ… æ¶ˆé™¤åŠŸèƒ½é‡å¤
- âœ… æ˜ç¡®èŒè´£åˆ†å·¥
- âœ… æé«˜ä»£ç å¤ç”¨æ€§
- âœ… å‡å°‘ç»´æŠ¤æˆæœ¬

### **æ¶æ„ä¼˜åŒ–**
- âœ… æ¸…æ™°çš„åˆ†å±‚æ¶æ„
- âœ… è®¡ç®—ä¸å±•ç¤ºåˆ†ç¦»
- âœ… ä¸šåŠ¡é€»è¾‘é›†ä¸­
- âœ… æ˜“äºæ‰©å±•å’Œæµ‹è¯•

### **æ€§èƒ½ä¼˜åŒ–**
- âœ… å‡å°‘ä»£ç ä½“ç§¯
- âœ… æé«˜åŠ è½½é€Ÿåº¦
- âœ… ä¼˜åŒ–å†…å­˜ä½¿ç”¨
- âœ… å‡å°‘é‡å¤è®¡ç®—

**ğŸš€ é€šè¿‡è¿™æ¬¡é‡æ„ï¼Œæˆ‘ä»¬å°†å»ºç«‹ä¸€ä¸ªæ¸…æ™°ã€é«˜æ•ˆã€æ˜“ç»´æŠ¤çš„æœåŠ¡æ¶æ„ï¼**
