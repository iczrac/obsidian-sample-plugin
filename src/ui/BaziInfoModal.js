import { Modal, Setting } from 'obsidian';
import { BaziService } from '../services/BaziService';
/**
 * 八字信息展示模态框
 */
export class BaziInfoModal extends Modal {
    constructor(app, baziInfo, onInsert) {
        super(app);
        this.baziInfo = baziInfo;
        this.onInsert = onInsert;
    }
    onOpen() {
        const { contentEl } = this;
        contentEl.createEl('h2', { text: '八字命盘信息' });
        // 创建信息容器
        const infoContainer = contentEl.createDiv({ cls: 'bazi-info-container' });
        // 生成HTML内容
        const id = 'bazi-view-' + Math.random().toString(36).substring(2, 9);
        const html = BaziService.generateBaziHTML(this.baziInfo, id);
        // 渲染HTML
        infoContainer.innerHTML = html;
        // 添加按钮
        const buttonContainer = contentEl.createDiv({ cls: 'bazi-button-container' });
        // 插入笔记按钮
        new Setting(buttonContainer)
            .addButton(button => {
            button.setButtonText('插入到笔记')
                .setCta()
                .onClick(() => {
                // 生成代码块
                const dateStr = `${this.baziInfo.solarDate} ${this.baziInfo.solarTime}`;
                const codeBlock = `\`\`\`bazi
date: ${dateStr}
\`\`\``;
                this.onInsert(codeBlock);
                this.close();
            });
        })
            .addButton(button => {
            button.setButtonText('关闭')
                .onClick(() => {
                this.close();
            });
        });
    }
    onClose() {
        const { contentEl } = this;
        contentEl.empty();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQmF6aUluZm9Nb2RhbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkJhemlJbmZvTW9kYWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFPLEtBQUssRUFBRSxPQUFPLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFFL0MsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBRXREOztHQUVHO0FBQ0gsTUFBTSxPQUFPLGFBQWMsU0FBUSxLQUFLO0lBSXRDLFlBQVksR0FBUSxFQUFFLFFBQWtCLEVBQUUsUUFBcUM7UUFDN0UsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ1gsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDekIsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7SUFDM0IsQ0FBQztJQUVELE1BQU07UUFDSixNQUFNLEVBQUUsU0FBUyxFQUFFLEdBQUcsSUFBSSxDQUFDO1FBRTNCLFNBQVMsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUM7UUFFN0MsU0FBUztRQUNULE1BQU0sYUFBYSxHQUFHLFNBQVMsQ0FBQyxTQUFTLENBQUMsRUFBRSxHQUFHLEVBQUUscUJBQXFCLEVBQUUsQ0FBQyxDQUFDO1FBRTFFLFdBQVc7UUFDWCxNQUFNLEVBQUUsR0FBRyxZQUFZLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3JFLE1BQU0sSUFBSSxHQUFHLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBRTdELFNBQVM7UUFDVCxhQUFhLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztRQUUvQixPQUFPO1FBQ1AsTUFBTSxlQUFlLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsRUFBRSx1QkFBdUIsRUFBRSxDQUFDLENBQUM7UUFFOUUsU0FBUztRQUNULElBQUksT0FBTyxDQUFDLGVBQWUsQ0FBQzthQUN6QixTQUFTLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDbEIsTUFBTSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUM7aUJBQzFCLE1BQU0sRUFBRTtpQkFDUixPQUFPLENBQUMsR0FBRyxFQUFFO2dCQUNaLFFBQVE7Z0JBQ1IsTUFBTSxPQUFPLEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsRUFBRSxDQUFDO2dCQUN4RSxNQUFNLFNBQVMsR0FBRztRQUN0QixPQUFPO09BQ1IsQ0FBQztnQkFDSSxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO2dCQUN6QixJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDZixDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQzthQUNELFNBQVMsQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUNsQixNQUFNLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQztpQkFDdkIsT0FBTyxDQUFDLEdBQUcsRUFBRTtnQkFDWixJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDZixDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVELE9BQU87UUFDTCxNQUFNLEVBQUUsU0FBUyxFQUFFLEdBQUcsSUFBSSxDQUFDO1FBQzNCLFNBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUNwQixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHAsIE1vZGFsLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQmF6aUluZm8gfSBmcm9tICcuLi90eXBlcy9CYXppSW5mbyc7XG5pbXBvcnQgeyBCYXppU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL0JhemlTZXJ2aWNlJztcblxuLyoqXG4gKiDlhavlrZfkv6Hmga/lsZXnpLrmqKHmgIHmoYZcbiAqL1xuZXhwb3J0IGNsYXNzIEJhemlJbmZvTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIHByaXZhdGUgYmF6aUluZm86IEJhemlJbmZvO1xuICBwcml2YXRlIG9uSW5zZXJ0OiAoY29kZUJsb2NrOiBzdHJpbmcpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGJhemlJbmZvOiBCYXppSW5mbywgb25JbnNlcnQ6IChjb2RlQmxvY2s6IHN0cmluZykgPT4gdm9pZCkge1xuICAgIHN1cGVyKGFwcCk7XG4gICAgdGhpcy5iYXppSW5mbyA9IGJhemlJbmZvO1xuICAgIHRoaXMub25JbnNlcnQgPSBvbkluc2VydDtcbiAgfVxuXG4gIG9uT3BlbigpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICflhavlrZflkb3nm5jkv6Hmga8nIH0pO1xuXG4gICAgLy8g5Yib5bu65L+h5oGv5a655ZmoXG4gICAgY29uc3QgaW5mb0NvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICdiYXppLWluZm8tY29udGFpbmVyJyB9KTtcblxuICAgIC8vIOeUn+aIkEhUTUzlhoXlrrlcbiAgICBjb25zdCBpZCA9ICdiYXppLXZpZXctJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCA5KTtcbiAgICBjb25zdCBodG1sID0gQmF6aVNlcnZpY2UuZ2VuZXJhdGVCYXppSFRNTCh0aGlzLmJhemlJbmZvLCBpZCk7XG5cbiAgICAvLyDmuLLmn5NIVE1MXG4gICAgaW5mb0NvbnRhaW5lci5pbm5lckhUTUwgPSBodG1sO1xuXG4gICAgLy8g5re75Yqg5oyJ6ZKuXG4gICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ2JhemktYnV0dG9uLWNvbnRhaW5lcicgfSk7XG5cbiAgICAvLyDmj5LlhaXnrJTorrDmjInpkq5cbiAgICBuZXcgU2V0dGluZyhidXR0b25Db250YWluZXIpXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XG4gICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KCfmj5LlhaXliLDnrJTorrAnKVxuICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIC8vIOeUn+aIkOS7o+eggeWdl1xuICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IGAke3RoaXMuYmF6aUluZm8uc29sYXJEYXRlfSAke3RoaXMuYmF6aUluZm8uc29sYXJUaW1lfWA7XG4gICAgICAgICAgICBjb25zdCBjb2RlQmxvY2sgPSBgXFxgXFxgXFxgYmF6aVxuZGF0ZTogJHtkYXRlU3RyfVxuXFxgXFxgXFxgYDtcbiAgICAgICAgICAgIHRoaXMub25JbnNlcnQoY29kZUJsb2NrKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XG4gICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KCflhbPpl60nKVxuICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pO1xuICB9XG5cbiAgb25DbG9zZSgpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgfVxufVxuIl19