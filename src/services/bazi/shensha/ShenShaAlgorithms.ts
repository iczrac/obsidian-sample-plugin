/**
 * ç¥ç…åŸºç¡€ç®—æ³•åº“
 * æä¾›æ‰€æœ‰ç¥ç…çš„åŸºç¡€åˆ¤æ–­æ–¹æ³•ï¼Œçº¯ç®—æ³•å®ç°ï¼Œæ— ä¸šåŠ¡é€»è¾‘
 *
 * ğŸ“‹ ç®—æ³•åº“è¯´æ˜ï¼š
 * - åŒ…å«52ä¸ªåŸºç¡€ç¥ç…ç®—æ³•ï¼ˆåŸ51ä¸ª + æ–°å¢æ—¥å¾·ï¼‰
 * - çº¯å‡½æ•°å®ç°ï¼Œæ— å‰¯ä½œç”¨ï¼Œæ˜“äºæµ‹è¯•
 * - ç»Ÿä¸€å‚æ•°æ ¼å¼ï¼Œä¾¿äºShenShaCalculationEngineè°ƒç”¨
 * - ä¸SpecialShenShaCalculatoråä½œï¼Œé¿å…é‡å¤å®ç°
 *
 * ğŸ”„ æ•´åˆå†å²ï¼š
 * - 2024-12: æ¶ˆé™¤ä¸SpecialShenShaCalculatorçš„é‡å ç®—æ³•
 * - ç»Ÿä¸€é­ç½¡ã€é˜´å·®é˜³é”™ã€åæ¶å¤§è´¥ã€å­¤é¸¾ç…çš„å®ç°
 * - æ–°å¢æ—¥å¾·ç®—æ³•ï¼Œå®Œå–„åŸºç¡€ç®—æ³•åº“
 *
 * ğŸ“ ä½¿ç”¨è¯´æ˜ï¼š
 * - åŸºç¡€ç¥ç…ï¼šç›´æ¥ä½¿ç”¨æœ¬ç®—æ³•åº“
 * - å¤æ‚ç¥ç…ï¼ˆç«¥å­ç…ã€å°†å†›ç®­ï¼‰ï¼šä½¿ç”¨SpecialShenShaCalculator
 * - æ‰€æœ‰ç®—æ³•é€šè¿‡ShenShaCalculationEngineç»Ÿä¸€è°ƒç”¨
 */
export class ShenShaAlgorithms {
  
  /**
   * åˆ¤æ–­å¤©ä¹™è´µäºº
   * @param dayStem æ—¥å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©ä¹™è´µäºº
   */
  static isTianYiGuiRen(dayStem: string, branch: string): boolean {
    // å¤©ä¹™è´µäººçš„è®¡ç®—è§„åˆ™ï¼š
    // ç”²æˆŠåºšç‰›ç¾Šï¼Œä¹™å·±é¼ çŒ´ä¹¡ï¼Œä¸™ä¸çŒªé¸¡ä½ï¼Œå£¬ç™¸è›‡å…”è—ï¼Œå…­è¾›é€¢é©¬è™
    const map: {[key: string]: string[]} = {
      'ç”²': ['ä¸‘', 'æœª'], 'æˆŠ': ['ä¸‘', 'æœª'], 'åºš': ['ä¸‘', 'æœª'],
      'ä¹™': ['å­', 'ç”³'], 'å·±': ['å­', 'ç”³'],
      'ä¸™': ['äº¥', 'é…‰'], 'ä¸': ['äº¥', 'é…‰'],
      'å£¬': ['å·³', 'å¯'], 'ç™¸': ['å·³', 'å¯'],
      'è¾›': ['åˆ', 'å¯…']
    };
    return map[dayStem]?.includes(branch) || false;
  }

  /**
   * åˆ¤æ–­ç¦„ç¥
   * @param stem å¤©å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºç¦„ç¥
   */
  static isLuShen(stem: string, branch: string): boolean {
    const map: {[key: string]: string} = {
      'ç”²': 'å¯…', 'ä¹™': 'å¯', 'ä¸™': 'å·³', 'ä¸': 'åˆ', 'æˆŠ': 'å·³',
      'å·±': 'åˆ', 'åºš': 'ç”³', 'è¾›': 'é…‰', 'å£¬': 'äº¥', 'ç™¸': 'å­'
    };
    return map[stem] === branch;
  }

  /**
   * åˆ¤æ–­ç¾Šåˆƒ
   * @param dayStem æ—¥å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºç¾Šåˆƒ
   */
  static isYangRen(dayStem: string, branch: string): boolean {
    const map: {[key: string]: string} = {
      'ç”²': 'å¯', 'ä¹™': 'å¯…', 'ä¸™': 'åˆ', 'ä¸': 'å·³', 'æˆŠ': 'åˆ',
      'å·±': 'å·³', 'åºš': 'é…‰', 'è¾›': 'ç”³', 'å£¬': 'å­', 'ç™¸': 'äº¥'
    };
    return map[dayStem] === branch;
  }

  /**
   * åˆ¤æ–­æ¡ƒèŠ±
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºæ¡ƒèŠ±
   */
  static isTaoHua(yearBranch: string, branch: string): boolean {
    // æ¡ƒèŠ±çš„è®¡ç®—è§„åˆ™ï¼šå¯…åˆæˆŒè§å¯ï¼Œç”³å­è¾°è§é…‰ï¼Œå·³é…‰ä¸‘è§åˆï¼Œäº¥å¯æœªè§å­
    const map: {[key: string]: string} = {
      'å¯…': 'å¯', 'åˆ': 'å¯', 'æˆŒ': 'å¯',
      'ç”³': 'é…‰', 'å­': 'é…‰', 'è¾°': 'é…‰',
      'å·³': 'åˆ', 'é…‰': 'åˆ', 'ä¸‘': 'åˆ',
      'äº¥': 'å­', 'å¯': 'å­', 'æœª': 'å­'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­åç›–
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºåç›–
   */
  static isHuaGai(yearBranch: string, branch: string): boolean {
    // åç›–çš„è®¡ç®—è§„åˆ™ï¼šå¯…åˆæˆŒè§æˆŒï¼Œç”³å­è¾°è§è¾°ï¼Œå·³é…‰ä¸‘è§ä¸‘ï¼Œäº¥å¯æœªè§æœª
    const map: {[key: string]: string} = {
      'å¯…': 'æˆŒ', 'åˆ': 'æˆŒ', 'æˆŒ': 'æˆŒ',
      'ç”³': 'è¾°', 'å­': 'è¾°', 'è¾°': 'è¾°',
      'å·³': 'ä¸‘', 'é…‰': 'ä¸‘', 'ä¸‘': 'ä¸‘',
      'äº¥': 'æœª', 'å¯': 'æœª', 'æœª': 'æœª'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­æ–‡æ˜Œ
   * @param yearStem å¹´å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºæ–‡æ˜Œ
   */
  static isWenChang(yearStem: string, branch: string): boolean {
    // æ–‡æ˜Œçš„è®¡ç®—è§„åˆ™ï¼šç”²ä¹™è§å·³ï¼Œä¸™ä¸è§ç”³ï¼ŒæˆŠå·±è§ç”³ï¼Œåºšè¾›è§äº¥ï¼Œå£¬ç™¸è§å¯…
    const map: {[key: string]: string} = {
      'ç”²': 'å·³', 'ä¹™': 'å·³',
      'ä¸™': 'ç”³', 'ä¸': 'ç”³',
      'æˆŠ': 'ç”³', 'å·±': 'ç”³',
      'åºš': 'äº¥', 'è¾›': 'äº¥',
      'å£¬': 'å¯…', 'ç™¸': 'å¯…'
    };
    return map[yearStem] === branch;
  }

  /**
   * åˆ¤æ–­å°†æ˜Ÿ
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå°†æ˜Ÿ
   */
  static isJiangXing(yearBranch: string, branch: string): boolean {
    // å°†æ˜Ÿçš„è®¡ç®—è§„åˆ™ï¼šå¯…åˆæˆŒè§åˆï¼Œç”³å­è¾°è§å­ï¼Œå·³é…‰ä¸‘è§é…‰ï¼Œäº¥å¯æœªè§å¯
    const map: {[key: string]: string} = {
      'å¯…': 'åˆ', 'åˆ': 'åˆ', 'æˆŒ': 'åˆ',
      'ç”³': 'å­', 'å­': 'å­', 'è¾°': 'å­',
      'å·³': 'é…‰', 'é…‰': 'é…‰', 'ä¸‘': 'é…‰',
      'äº¥': 'å¯', 'å¯': 'å¯', 'æœª': 'å¯'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­é©¿é©¬
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºé©¿é©¬
   */
  static isYiMa(yearBranch: string, branch: string): boolean {
    // é©¿é©¬çš„è®¡ç®—è§„åˆ™ï¼šå¯…åˆæˆŒè§ç”³ï¼Œç”³å­è¾°è§å¯…ï¼Œå·³é…‰ä¸‘è§äº¥ï¼Œäº¥å¯æœªè§å·³
    const map: {[key: string]: string} = {
      'å¯…': 'ç”³', 'åˆ': 'ç”³', 'æˆŒ': 'ç”³',
      'ç”³': 'å¯…', 'å­': 'å¯…', 'è¾°': 'å¯…',
      'å·³': 'äº¥', 'é…‰': 'äº¥', 'ä¸‘': 'äº¥',
      'äº¥': 'å·³', 'å¯': 'å·³', 'æœª': 'å·³'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­å¤©å¾·
   * @param monthBranch æœˆæ”¯
   * @param stem å¤©å¹²
   * @returns æ˜¯å¦ä¸ºå¤©å¾·
   */
  static isTianDe(monthBranch: string, stem: string): boolean {
    // å¤©å¾·çš„è®¡ç®—è§„åˆ™ï¼šæ ¹æ®æœˆä»½æŸ¥è¯¢å¯¹åº”çš„å¤©å¹²
    // æ­£æœˆä¸ï¼ŒäºŒæœˆç”³ï¼Œä¸‰æœˆå£¬ï¼Œå››æœˆè¾›ï¼Œäº”æœˆäº¥ï¼Œå…­æœˆç”²ï¼Œä¸ƒæœˆç™¸ï¼Œå…«æœˆå¯…ï¼Œä¹æœˆä¸™ï¼Œåæœˆä¹™ï¼Œåä¸€æœˆå·³ï¼ŒåäºŒæœˆåºš
    const monthToNumber: {[key: string]: number} = {
      'å¯…': 1, 'å¯': 2, 'è¾°': 3, 'å·³': 4, 'åˆ': 5, 'æœª': 6,
      'ç”³': 7, 'é…‰': 8, 'æˆŒ': 9, 'äº¥': 10, 'å­': 11, 'ä¸‘': 12
    };

    const tianDeMap: {[key: number]: string} = {
      1: 'ä¸',   // æ­£æœˆ
      2: 'ç”³',   // äºŒæœˆï¼ˆåœ°æ”¯ï¼‰
      3: 'å£¬',   // ä¸‰æœˆ
      4: 'è¾›',   // å››æœˆ
      5: 'äº¥',   // äº”æœˆï¼ˆåœ°æ”¯ï¼‰
      6: 'ç”²',   // å…­æœˆ
      7: 'ç™¸',   // ä¸ƒæœˆ
      8: 'å¯…',   // å…«æœˆï¼ˆåœ°æ”¯ï¼‰
      9: 'ä¸™',   // ä¹æœˆ
      10: 'ä¹™',  // åæœˆ
      11: 'å·³',  // åä¸€æœˆï¼ˆåœ°æ”¯ï¼‰
      12: 'åºš'   // åäºŒæœˆ
    };

    const monthNumber = monthToNumber[monthBranch];
    return monthNumber ? tianDeMap[monthNumber] === stem : false;
  }

  /**
   * åˆ¤æ–­æœˆå¾·
   * @param monthBranch æœˆæ”¯
   * @param stem å¤©å¹²
   * @returns æ˜¯å¦ä¸ºæœˆå¾·
   */
  static isYueDe(monthBranch: string, stem: string): boolean {
    // æœˆå¾·çš„è®¡ç®—è§„åˆ™ï¼šæ ¹æ®æœˆä»½æŸ¥è¯¢å¯¹åº”çš„å¤©å¹²
    // æ­£æœˆä¸™ï¼ŒäºŒæœˆç”²ï¼Œä¸‰æœˆä¸ï¼Œå››æœˆè¾›ï¼Œäº”æœˆå·±ï¼Œå…­æœˆä¸ï¼Œä¸ƒæœˆå£¬ï¼Œå…«æœˆè¾›ï¼Œä¹æœˆæˆŠï¼Œåæœˆä¹™ï¼Œåä¸€æœˆå·±ï¼ŒåäºŒæœˆä¸
    const monthToNumber: {[key: string]: number} = {
      'å¯…': 1, 'å¯': 2, 'è¾°': 3, 'å·³': 4, 'åˆ': 5, 'æœª': 6,
      'ç”³': 7, 'é…‰': 8, 'æˆŒ': 9, 'äº¥': 10, 'å­': 11, 'ä¸‘': 12
    };

    const yueDeMap: {[key: number]: string} = {
      1: 'ä¸™',   // æ­£æœˆ
      2: 'ç”²',   // äºŒæœˆ
      3: 'ä¸',   // ä¸‰æœˆ
      4: 'è¾›',   // å››æœˆ
      5: 'å·±',   // äº”æœˆ
      6: 'ä¸',   // å…­æœˆ
      7: 'å£¬',   // ä¸ƒæœˆ
      8: 'è¾›',   // å…«æœˆ
      9: 'æˆŠ',   // ä¹æœˆ
      10: 'ä¹™',  // åæœˆ
      11: 'å·±',  // åä¸€æœˆ
      12: 'ä¸'   // åäºŒæœˆ
    };

    const monthNumber = monthToNumber[monthBranch];
    return monthNumber ? yueDeMap[monthNumber] === stem : false;
  }

  /**
   * åˆ¤æ–­å¤©åŒ»
   * @param yearStem å¹´å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©åŒ»
   */
  static isTianYi(yearStem: string, branch: string): boolean {
    // å¤©åŒ»çš„è®¡ç®—è§„åˆ™ï¼šæ ¹æ®å¹´å¹²æŸ¥è¯¢å¯¹åº”çš„åœ°æ”¯
    // ç”²è§ä¸‘ï¼Œä¹™è§å­ï¼Œä¸™è§äº¥ï¼Œä¸è§æˆŒï¼ŒæˆŠè§é…‰ï¼Œå·±è§ç”³ï¼Œåºšè§æœªï¼Œè¾›è§åˆï¼Œå£¬è§å·³ï¼Œç™¸è§è¾°
    const tianYiMap: {[key: string]: string} = {
      'ç”²': 'ä¸‘',
      'ä¹™': 'å­',
      'ä¸™': 'äº¥',
      'ä¸': 'æˆŒ',
      'æˆŠ': 'é…‰',
      'å·±': 'ç”³',
      'åºš': 'æœª',
      'è¾›': 'åˆ',
      'å£¬': 'å·³',
      'ç™¸': 'è¾°'
    };

    return tianYiMap[yearStem] === branch;
  }

  /**
   * åˆ¤æ–­åŠ«ç…
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºåŠ«ç…
   */
  static isJieSha(yearBranch: string, branch: string): boolean {
    // åŠ«ç…çš„è®¡ç®—è§„åˆ™ï¼šå¯…åˆæˆŒè§äº¥ï¼Œç”³å­è¾°è§å·³ï¼Œå·³é…‰ä¸‘è§å¯…ï¼Œäº¥å¯æœªè§ç”³
    const map: {[key: string]: string} = {
      'å¯…': 'äº¥', 'åˆ': 'äº¥', 'æˆŒ': 'äº¥',
      'ç”³': 'å·³', 'å­': 'å·³', 'è¾°': 'å·³',
      'å·³': 'å¯…', 'é…‰': 'å¯…', 'ä¸‘': 'å¯…',
      'äº¥': 'ç”³', 'å¯': 'ç”³', 'æœª': 'ç”³'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­ç¾ç…
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºç¾ç…
   */
  static isZaiSha(yearBranch: string, branch: string): boolean {
    // ç¾ç…çš„è®¡ç®—è§„åˆ™ï¼šå¯…åˆæˆŒè§å­ï¼Œç”³å­è¾°è§åˆï¼Œå·³é…‰ä¸‘è§å¯ï¼Œäº¥å¯æœªè§é…‰
    const map: {[key: string]: string} = {
      'å¯…': 'å­', 'åˆ': 'å­', 'æˆŒ': 'å­',
      'ç”³': 'åˆ', 'å­': 'åˆ', 'è¾°': 'åˆ',
      'å·³': 'å¯', 'é…‰': 'å¯', 'ä¸‘': 'å¯',
      'äº¥': 'é…‰', 'å¯': 'é…‰', 'æœª': 'é…‰'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­å¤©åˆ‘
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©åˆ‘
   */
  static isTianXing(yearBranch: string, branch: string): boolean {
    // å¤©åˆ‘çš„è®¡ç®—è§„åˆ™ï¼šå¯…åˆæˆŒè§å¯…ï¼Œç”³å­è¾°è§ç”³ï¼Œå·³é…‰ä¸‘è§å·³ï¼Œäº¥å¯æœªè§äº¥
    const map: {[key: string]: string} = {
      'å¯…': 'å¯…', 'åˆ': 'å¯…', 'æˆŒ': 'å¯…',
      'ç”³': 'ç”³', 'å­': 'ç”³', 'è¾°': 'ç”³',
      'å·³': 'å·³', 'é…‰': 'å·³', 'ä¸‘': 'å·³',
      'äº¥': 'äº¥', 'å¯': 'äº¥', 'æœª': 'äº¥'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­å­¤è¾°
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå­¤è¾°
   */
  static isGuChen(yearBranch: string, branch: string): boolean {
    // å­¤è¾°çš„è®¡ç®—è§„åˆ™ï¼šå¯…å¯è¾°è§å¯…ï¼Œå·³åˆæœªè§å·³ï¼Œç”³é…‰æˆŒè§ç”³ï¼Œäº¥å­ä¸‘è§äº¥
    const map: {[key: string]: string} = {
      'å¯…': 'å¯…', 'å¯': 'å¯…', 'è¾°': 'å¯…',
      'å·³': 'å·³', 'åˆ': 'å·³', 'æœª': 'å·³',
      'ç”³': 'ç”³', 'é…‰': 'ç”³', 'æˆŒ': 'ç”³',
      'äº¥': 'äº¥', 'å­': 'äº¥', 'ä¸‘': 'äº¥'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­å¯¡å®¿
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¯¡å®¿
   */
  static isGuaSu(yearBranch: string, branch: string): boolean {
    // å¯¡å®¿çš„è®¡ç®—è§„åˆ™ï¼šå¯…å¯è¾°è§æˆŒï¼Œå·³åˆæœªè§ä¸‘ï¼Œç”³é…‰æˆŒè§è¾°ï¼Œäº¥å­ä¸‘è§æœª
    const map: {[key: string]: string} = {
      'å¯…': 'æˆŒ', 'å¯': 'æˆŒ', 'è¾°': 'æˆŒ',
      'å·³': 'ä¸‘', 'åˆ': 'ä¸‘', 'æœª': 'ä¸‘',
      'ç”³': 'è¾°', 'é…‰': 'è¾°', 'æˆŒ': 'è¾°',
      'äº¥': 'æœª', 'å­': 'æœª', 'ä¸‘': 'æœª'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­é­ç½¡
   * @param ganZhi å¹²æ”¯ç»„åˆ
   * @returns æ˜¯å¦ä¸ºé­ç½¡
   */
  static isKuiGang(ganZhi: string): boolean {
    const kuiGangDays = ['åºšæˆŒ', 'åºšè¾°', 'æˆŠæˆŒ', 'å£¬è¾°'];
    return kuiGangDays.includes(ganZhi);
  }

  /**
   * åˆ¤æ–­é˜´å·®é˜³é”™
   * @param ganZhi å¹²æ”¯ç»„åˆ
   * @returns æ˜¯å¦ä¸ºé˜´å·®é˜³é”™
   */
  static isYinChaYangCuo(ganZhi: string): boolean {
    const yinChaYangCuoDays = [
      'ä¸™å­', 'ä¸ä¸‘', 'æˆŠå¯…', 'è¾›å¯', 'å£¬è¾°', 'ç™¸å·³',
      'ä¸™åˆ', 'ä¸æœª', 'æˆŠç”³', 'è¾›é…‰', 'å£¬æˆŒ', 'ç™¸äº¥'
    ];
    return yinChaYangCuoDays.includes(ganZhi);
  }

  /**
   * è·å–ç¥ç…ç±»å‹ï¼ˆå‰ç¥ã€å‡¶ç¥ã€å‰å‡¶ç¥ï¼‰
   * @param shenSha ç¥ç…åç§°
   * @returns ç¥ç…ç±»å‹
   */
  static getShenShaType(shenSha: string): string {
    // å»é™¤å¯èƒ½çš„å‰ç¼€ï¼ˆå¦‚"å¹´æŸ±:"ï¼‰
    const pureShenSha = shenSha.includes(':') ? shenSha.split(':')[1] : shenSha;

    // å‰ç¥åˆ—è¡¨
    const goodShenSha = [
      'å¤©ä¹™è´µäºº', 'æ–‡æ˜Œ', 'æ–‡æ›²', 'å¤©å¾·', 'æœˆå¾·', 'å¤©ç¦', 'å¤©å®˜', 'å¤©å¨',
      'å¤©å·«', 'å¤©æœˆ', 'å¤©å–œ', 'å¤©èµ¦', 'å¤©æ©', 'é©¿é©¬', 'ç¦„ç¥', 'å›½å°',
      'å¤©åŒ»', 'å¤©è´µ', 'å¤©æ‰', 'å¤©å¯¿', 'å¤©é¦¨', 'å¤©é’º', 'å¤©äº¨', 'å¤©è§£',
      'å¤©æŠ¥', 'å¤©åº†', 'å¤©ç¥¥', 'å¤©ä½‘', 'å¤©å¯Œ', 'å¤©çˆµ', 'å¤©å¾·åˆ', 'æœˆå¾·åˆ',
      'å¤ªæè´µäºº', 'é‡‘èˆ†', 'å›½å°è´µäºº', 'ä¸‰å¥‡è´µäºº', 'ç¦æ˜Ÿè´µäºº', 'å­¦å ‚è¯é¦†',
      'å¾·ç§€è´µäºº', 'è§£ç¥', 'é‡‘ç¥'
    ];

    // å‡¶ç¥åˆ—è¡¨
    const badShenSha = [
      'å¤©åˆ‘', 'å¤©å“­', 'å¤©è™š', 'äº¡ç¥', 'åŠ«ç…', 'ç¾ç…', 'äº”é¬¼',
      'å¤©ç½—', 'åœ°ç½‘', 'åœ°ä¸', 'é˜´å·®', 'é­ç½¡', 'å­¤è¾°', 'å¯¡å®¿', 'ç™½è™',
      'å¤©ç‹—', 'å¤©ç‹±', 'å¤©æ£’', 'å¤©ç‰¢', 'å¤©ç¥¸', 'å¤©ç…', 'å¤©å',
      'å¤©å¥¸', 'å¤©è®¼', 'ç¾Šåˆƒ', 'é˜´å·®é˜³é”™', 'ç©ºäº¡', 'åæ¶å¤§è´¥',
      'æŠ«éº»', 'åŠå®¢', 'ä¸§é—¨', 'å…ƒè¾°', 'å­¤é¸¾ç…', 'å››åºŸ', 'å¤©ç½—åœ°ç½‘',
      'å¤©ç©º', 'åœ°åŠ«'
    ];

    // å‰å‡¶ç¥åˆ—è¡¨ï¼ˆæ ¹æ®ä¸åŒæƒ…å†µå¯èƒ½å‰å¯èƒ½å‡¶ï¼‰
    const mixedShenSha = [
      'å°†æ˜Ÿ', 'åç›–', 'æ¡ƒèŠ±', 'ä¸‰å°', 'å…«åº§', 'æ©å…‰', 'å¤©è´µ', 'å°è¾…',
      'å°è¯°', 'å¤©ä½¿', 'å¤©ä¼¤', 'æˆªè·¯', 'æ—¬ç©º', 'ä¸‰å¥‡', 'å…­ä»ª',
      'ä¸‰åˆ', 'å…­åˆ', 'æš—åˆ', 'æ‹±åˆ', 'ä¸‰ä¼š', 'ä¸‰åˆ‘', 'å…­å†²', 'æš—å†²',
      'ç«¥å­ç…', 'å°†å†›ç®­', 'çº¢è‰³', 'çº¢é¸¾', 'å¤©å§š', 'å’¸æ± ', 'å¤©å–œ'
    ];

    if (goodShenSha.includes(pureShenSha)) {
      return 'å‰ç¥';
    } else if (badShenSha.includes(pureShenSha)) {
      return 'å‡¶ç¥';
    } else if (mixedShenSha.includes(pureShenSha)) {
      return 'å‰å‡¶ç¥';
    }

    return 'æœªçŸ¥';
  }

  /**
   * åˆ¤æ–­ç©ºäº¡
   * @param dayStem æ—¥å¹²
   * @param dayBranch æ—¥æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºç©ºäº¡
   */
  static isKongWang(dayStem: string, dayBranch: string, branch: string): boolean {
    // ç©ºäº¡çš„è®¡ç®—è§„åˆ™ï¼šæ ¹æ®æ—¥æŸ±æŸ¥æ—¬ç©º
    // ç”²å­æ—¬ç©ºæˆŒäº¥ï¼Œç”²æˆŒæ—¬ç©ºç”³é…‰ï¼Œç”²ç”³æ—¬ç©ºåˆæœªï¼Œç”²åˆæ—¬ç©ºè¾°å·³ï¼Œç”²è¾°æ—¬ç©ºå¯…å¯ï¼Œç”²å¯…æ—¬ç©ºå­ä¸‘
    const dayGanZhi = dayStem + dayBranch;

    // ç¡®å®šæ—¥æŸ±æ‰€åœ¨çš„æ—¬
    const xunMap: {[key: string]: string[]} = {
      // ç”²å­æ—¬ï¼ˆç”²å­ã€ä¹™ä¸‘ã€ä¸™å¯…ã€ä¸å¯ã€æˆŠè¾°ã€å·±å·³ã€åºšåˆã€è¾›æœªã€å£¬ç”³ã€ç™¸é…‰ï¼‰
      'ç”²å­': ['æˆŒ', 'äº¥'], 'ä¹™ä¸‘': ['æˆŒ', 'äº¥'], 'ä¸™å¯…': ['æˆŒ', 'äº¥'], 'ä¸å¯': ['æˆŒ', 'äº¥'], 'æˆŠè¾°': ['æˆŒ', 'äº¥'],
      'å·±å·³': ['æˆŒ', 'äº¥'], 'åºšåˆ': ['æˆŒ', 'äº¥'], 'è¾›æœª': ['æˆŒ', 'äº¥'], 'å£¬ç”³': ['æˆŒ', 'äº¥'], 'ç™¸é…‰': ['æˆŒ', 'äº¥'],

      // ç”²æˆŒæ—¬ï¼ˆç”²æˆŒã€ä¹™äº¥ã€ä¸™å­ã€ä¸ä¸‘ã€æˆŠå¯…ã€å·±å¯ã€åºšè¾°ã€è¾›å·³ã€å£¬åˆã€ç™¸æœªï¼‰
      'ç”²æˆŒ': ['ç”³', 'é…‰'], 'ä¹™äº¥': ['ç”³', 'é…‰'], 'ä¸™å­': ['ç”³', 'é…‰'], 'ä¸ä¸‘': ['ç”³', 'é…‰'], 'æˆŠå¯…': ['ç”³', 'é…‰'],
      'å·±å¯': ['ç”³', 'é…‰'], 'åºšè¾°': ['ç”³', 'é…‰'], 'è¾›å·³': ['ç”³', 'é…‰'], 'å£¬åˆ': ['ç”³', 'é…‰'], 'ç™¸æœª': ['ç”³', 'é…‰'],

      // ç”²ç”³æ—¬ï¼ˆç”²ç”³ã€ä¹™é…‰ã€ä¸™æˆŒã€ä¸äº¥ã€æˆŠå­ã€å·±ä¸‘ã€åºšå¯…ã€è¾›å¯ã€å£¬è¾°ã€ç™¸å·³ï¼‰
      'ç”²ç”³': ['åˆ', 'æœª'], 'ä¹™é…‰': ['åˆ', 'æœª'], 'ä¸™æˆŒ': ['åˆ', 'æœª'], 'ä¸äº¥': ['åˆ', 'æœª'], 'æˆŠå­': ['åˆ', 'æœª'],
      'å·±ä¸‘': ['åˆ', 'æœª'], 'åºšå¯…': ['åˆ', 'æœª'], 'è¾›å¯': ['åˆ', 'æœª'], 'å£¬è¾°': ['åˆ', 'æœª'], 'ç™¸å·³': ['åˆ', 'æœª'],

      // ç”²åˆæ—¬ï¼ˆç”²åˆã€ä¹™æœªã€ä¸™ç”³ã€ä¸é…‰ã€æˆŠæˆŒã€å·±äº¥ã€åºšå­ã€è¾›ä¸‘ã€å£¬å¯…ã€ç™¸å¯ï¼‰
      'ç”²åˆ': ['è¾°', 'å·³'], 'ä¹™æœª': ['è¾°', 'å·³'], 'ä¸™ç”³': ['è¾°', 'å·³'], 'ä¸é…‰': ['è¾°', 'å·³'], 'æˆŠæˆŒ': ['è¾°', 'å·³'],
      'å·±äº¥': ['è¾°', 'å·³'], 'åºšå­': ['è¾°', 'å·³'], 'è¾›ä¸‘': ['è¾°', 'å·³'], 'å£¬å¯…': ['è¾°', 'å·³'], 'ç™¸å¯': ['è¾°', 'å·³'],

      // ç”²è¾°æ—¬ï¼ˆç”²è¾°ã€ä¹™å·³ã€ä¸™åˆã€ä¸æœªã€æˆŠç”³ã€å·±é…‰ã€åºšæˆŒã€è¾›äº¥ã€å£¬å­ã€ç™¸ä¸‘ï¼‰
      'ç”²è¾°': ['å¯…', 'å¯'], 'ä¹™å·³': ['å¯…', 'å¯'], 'ä¸™åˆ': ['å¯…', 'å¯'], 'ä¸æœª': ['å¯…', 'å¯'], 'æˆŠç”³': ['å¯…', 'å¯'],
      'å·±é…‰': ['å¯…', 'å¯'], 'åºšæˆŒ': ['å¯…', 'å¯'], 'è¾›äº¥': ['å¯…', 'å¯'], 'å£¬å­': ['å¯…', 'å¯'], 'ç™¸ä¸‘': ['å¯…', 'å¯'],

      // ç”²å¯…æ—¬ï¼ˆç”²å¯…ã€ä¹™å¯ã€ä¸™è¾°ã€ä¸å·³ã€æˆŠåˆã€å·±æœªã€åºšç”³ã€è¾›é…‰ã€å£¬æˆŒã€ç™¸äº¥ï¼‰
      'ç”²å¯…': ['å­', 'ä¸‘'], 'ä¹™å¯': ['å­', 'ä¸‘'], 'ä¸™è¾°': ['å­', 'ä¸‘'], 'ä¸å·³': ['å­', 'ä¸‘'], 'æˆŠåˆ': ['å­', 'ä¸‘'],
      'å·±æœª': ['å­', 'ä¸‘'], 'åºšç”³': ['å­', 'ä¸‘'], 'è¾›é…‰': ['å­', 'ä¸‘'], 'å£¬æˆŒ': ['å­', 'ä¸‘'], 'ç™¸äº¥': ['å­', 'ä¸‘']
    };

    return xunMap[dayGanZhi]?.includes(branch) || false;
  }

  /**
   * åˆ¤æ–­å¹´ç©ºäº¡
   * @param yearStem å¹´å¹²
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¹´ç©ºäº¡
   */
  static isNianKongWang(yearStem: string, yearBranch: string, branch: string): boolean {
    // å¹´ç©ºäº¡ï¼šæ ¹æ®å¹´æŸ±æŸ¥æ—¬ç©º
    const yearGanZhi = yearStem + yearBranch;

    // å®Œæ•´çš„æ—¬ç©ºæ˜ å°„è¡¨
    const xunMap: {[key: string]: string[]} = {
      'ç”²å­': ['æˆŒ', 'äº¥'], 'ä¹™ä¸‘': ['æˆŒ', 'äº¥'], 'ä¸™å¯…': ['æˆŒ', 'äº¥'], 'ä¸å¯': ['æˆŒ', 'äº¥'], 'æˆŠè¾°': ['æˆŒ', 'äº¥'],
      'å·±å·³': ['æˆŒ', 'äº¥'], 'åºšåˆ': ['æˆŒ', 'äº¥'], 'è¾›æœª': ['æˆŒ', 'äº¥'], 'å£¬ç”³': ['æˆŒ', 'äº¥'], 'ç™¸é…‰': ['æˆŒ', 'äº¥'],
      'ç”²æˆŒ': ['ç”³', 'é…‰'], 'ä¹™äº¥': ['ç”³', 'é…‰'], 'ä¸™å­': ['ç”³', 'é…‰'], 'ä¸ä¸‘': ['ç”³', 'é…‰'], 'æˆŠå¯…': ['ç”³', 'é…‰'],
      'å·±å¯': ['ç”³', 'é…‰'], 'åºšè¾°': ['ç”³', 'é…‰'], 'è¾›å·³': ['ç”³', 'é…‰'], 'å£¬åˆ': ['ç”³', 'é…‰'], 'ç™¸æœª': ['ç”³', 'é…‰'],
      'ç”²ç”³': ['åˆ', 'æœª'], 'ä¹™é…‰': ['åˆ', 'æœª'], 'ä¸™æˆŒ': ['åˆ', 'æœª'], 'ä¸äº¥': ['åˆ', 'æœª'], 'æˆŠå­': ['åˆ', 'æœª'],
      'å·±ä¸‘': ['åˆ', 'æœª'], 'åºšå¯…': ['åˆ', 'æœª'], 'è¾›å¯': ['åˆ', 'æœª'], 'å£¬è¾°': ['åˆ', 'æœª'], 'ç™¸å·³': ['åˆ', 'æœª'],
      'ç”²åˆ': ['è¾°', 'å·³'], 'ä¹™æœª': ['è¾°', 'å·³'], 'ä¸™ç”³': ['è¾°', 'å·³'], 'ä¸é…‰': ['è¾°', 'å·³'], 'æˆŠæˆŒ': ['è¾°', 'å·³'],
      'å·±äº¥': ['è¾°', 'å·³'], 'åºšå­': ['è¾°', 'å·³'], 'è¾›ä¸‘': ['è¾°', 'å·³'], 'å£¬å¯…': ['è¾°', 'å·³'], 'ç™¸å¯': ['è¾°', 'å·³'],
      'ç”²è¾°': ['å¯…', 'å¯'], 'ä¹™å·³': ['å¯…', 'å¯'], 'ä¸™åˆ': ['å¯…', 'å¯'], 'ä¸æœª': ['å¯…', 'å¯'], 'æˆŠç”³': ['å¯…', 'å¯'],
      'å·±é…‰': ['å¯…', 'å¯'], 'åºšæˆŒ': ['å¯…', 'å¯'], 'è¾›äº¥': ['å¯…', 'å¯'], 'å£¬å­': ['å¯…', 'å¯'], 'ç™¸ä¸‘': ['å¯…', 'å¯'],
      'ç”²å¯…': ['å­', 'ä¸‘'], 'ä¹™å¯': ['å­', 'ä¸‘'], 'ä¸™è¾°': ['å­', 'ä¸‘'], 'ä¸å·³': ['å­', 'ä¸‘'], 'æˆŠåˆ': ['å­', 'ä¸‘'],
      'å·±æœª': ['å­', 'ä¸‘'], 'åºšç”³': ['å­', 'ä¸‘'], 'è¾›é…‰': ['å­', 'ä¸‘'], 'å£¬æˆŒ': ['å­', 'ä¸‘'], 'ç™¸äº¥': ['å­', 'ä¸‘']
    };

    return xunMap[yearGanZhi]?.includes(branch) || false;
  }

  /**
   * åˆ¤æ–­æœˆç©ºäº¡
   * @param monthStem æœˆå¹²
   * @param monthBranch æœˆæ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºæœˆç©ºäº¡
   */
  static isYueKongWang(monthStem: string, monthBranch: string, branch: string): boolean {
    // æœˆç©ºäº¡ï¼šæ ¹æ®æœˆæŸ±æŸ¥æ—¬ç©º
    const monthGanZhi = monthStem + monthBranch;

    // å®Œæ•´çš„æ—¬ç©ºæ˜ å°„è¡¨
    const xunMap: {[key: string]: string[]} = {
      'ç”²å­': ['æˆŒ', 'äº¥'], 'ä¹™ä¸‘': ['æˆŒ', 'äº¥'], 'ä¸™å¯…': ['æˆŒ', 'äº¥'], 'ä¸å¯': ['æˆŒ', 'äº¥'], 'æˆŠè¾°': ['æˆŒ', 'äº¥'],
      'å·±å·³': ['æˆŒ', 'äº¥'], 'åºšåˆ': ['æˆŒ', 'äº¥'], 'è¾›æœª': ['æˆŒ', 'äº¥'], 'å£¬ç”³': ['æˆŒ', 'äº¥'], 'ç™¸é…‰': ['æˆŒ', 'äº¥'],
      'ç”²æˆŒ': ['ç”³', 'é…‰'], 'ä¹™äº¥': ['ç”³', 'é…‰'], 'ä¸™å­': ['ç”³', 'é…‰'], 'ä¸ä¸‘': ['ç”³', 'é…‰'], 'æˆŠå¯…': ['ç”³', 'é…‰'],
      'å·±å¯': ['ç”³', 'é…‰'], 'åºšè¾°': ['ç”³', 'é…‰'], 'è¾›å·³': ['ç”³', 'é…‰'], 'å£¬åˆ': ['ç”³', 'é…‰'], 'ç™¸æœª': ['ç”³', 'é…‰'],
      'ç”²ç”³': ['åˆ', 'æœª'], 'ä¹™é…‰': ['åˆ', 'æœª'], 'ä¸™æˆŒ': ['åˆ', 'æœª'], 'ä¸äº¥': ['åˆ', 'æœª'], 'æˆŠå­': ['åˆ', 'æœª'],
      'å·±ä¸‘': ['åˆ', 'æœª'], 'åºšå¯…': ['åˆ', 'æœª'], 'è¾›å¯': ['åˆ', 'æœª'], 'å£¬è¾°': ['åˆ', 'æœª'], 'ç™¸å·³': ['åˆ', 'æœª'],
      'ç”²åˆ': ['è¾°', 'å·³'], 'ä¹™æœª': ['è¾°', 'å·³'], 'ä¸™ç”³': ['è¾°', 'å·³'], 'ä¸é…‰': ['è¾°', 'å·³'], 'æˆŠæˆŒ': ['è¾°', 'å·³'],
      'å·±äº¥': ['è¾°', 'å·³'], 'åºšå­': ['è¾°', 'å·³'], 'è¾›ä¸‘': ['è¾°', 'å·³'], 'å£¬å¯…': ['è¾°', 'å·³'], 'ç™¸å¯': ['è¾°', 'å·³'],
      'ç”²è¾°': ['å¯…', 'å¯'], 'ä¹™å·³': ['å¯…', 'å¯'], 'ä¸™åˆ': ['å¯…', 'å¯'], 'ä¸æœª': ['å¯…', 'å¯'], 'æˆŠç”³': ['å¯…', 'å¯'],
      'å·±é…‰': ['å¯…', 'å¯'], 'åºšæˆŒ': ['å¯…', 'å¯'], 'è¾›äº¥': ['å¯…', 'å¯'], 'å£¬å­': ['å¯…', 'å¯'], 'ç™¸ä¸‘': ['å¯…', 'å¯'],
      'ç”²å¯…': ['å­', 'ä¸‘'], 'ä¹™å¯': ['å­', 'ä¸‘'], 'ä¸™è¾°': ['å­', 'ä¸‘'], 'ä¸å·³': ['å­', 'ä¸‘'], 'æˆŠåˆ': ['å­', 'ä¸‘'],
      'å·±æœª': ['å­', 'ä¸‘'], 'åºšç”³': ['å­', 'ä¸‘'], 'è¾›é…‰': ['å­', 'ä¸‘'], 'å£¬æˆŒ': ['å­', 'ä¸‘'], 'ç™¸äº¥': ['å­', 'ä¸‘']
    };

    return xunMap[monthGanZhi]?.includes(branch) || false;
  }

  /**
   * åˆ¤æ–­æ—¥ç©ºäº¡ï¼ˆåŸæœ‰çš„ç©ºäº¡ç®—æ³•ï¼‰
   * @param dayStem æ—¥å¹²
   * @param dayBranch æ—¥æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºæ—¥ç©ºäº¡
   */
  static isRiKongWang(dayStem: string, dayBranch: string, branch: string): boolean {
    // æ—¥ç©ºäº¡ï¼šæ ¹æ®æ—¥æŸ±æŸ¥æ—¬ç©ºï¼ˆä¸åŸæœ‰ç©ºäº¡ç®—æ³•ç›¸åŒï¼‰
    return ShenShaAlgorithms.isKongWang(dayStem, dayBranch, branch);
  }

  /**
   * åˆ¤æ–­æ—¶ç©ºäº¡
   * @param hourStem æ—¶å¹²
   * @param hourBranch æ—¶æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºæ—¶ç©ºäº¡
   */
  static isShiKongWang(hourStem: string, hourBranch: string, branch: string): boolean {
    // æ—¶ç©ºäº¡ï¼šæ ¹æ®æ—¶æŸ±æŸ¥æ—¬ç©º
    const hourGanZhi = hourStem + hourBranch;

    // å®Œæ•´çš„æ—¬ç©ºæ˜ å°„è¡¨
    const xunMap: {[key: string]: string[]} = {
      'ç”²å­': ['æˆŒ', 'äº¥'], 'ä¹™ä¸‘': ['æˆŒ', 'äº¥'], 'ä¸™å¯…': ['æˆŒ', 'äº¥'], 'ä¸å¯': ['æˆŒ', 'äº¥'], 'æˆŠè¾°': ['æˆŒ', 'äº¥'],
      'å·±å·³': ['æˆŒ', 'äº¥'], 'åºšåˆ': ['æˆŒ', 'äº¥'], 'è¾›æœª': ['æˆŒ', 'äº¥'], 'å£¬ç”³': ['æˆŒ', 'äº¥'], 'ç™¸é…‰': ['æˆŒ', 'äº¥'],
      'ç”²æˆŒ': ['ç”³', 'é…‰'], 'ä¹™äº¥': ['ç”³', 'é…‰'], 'ä¸™å­': ['ç”³', 'é…‰'], 'ä¸ä¸‘': ['ç”³', 'é…‰'], 'æˆŠå¯…': ['ç”³', 'é…‰'],
      'å·±å¯': ['ç”³', 'é…‰'], 'åºšè¾°': ['ç”³', 'é…‰'], 'è¾›å·³': ['ç”³', 'é…‰'], 'å£¬åˆ': ['ç”³', 'é…‰'], 'ç™¸æœª': ['ç”³', 'é…‰'],
      'ç”²ç”³': ['åˆ', 'æœª'], 'ä¹™é…‰': ['åˆ', 'æœª'], 'ä¸™æˆŒ': ['åˆ', 'æœª'], 'ä¸äº¥': ['åˆ', 'æœª'], 'æˆŠå­': ['åˆ', 'æœª'],
      'å·±ä¸‘': ['åˆ', 'æœª'], 'åºšå¯…': ['åˆ', 'æœª'], 'è¾›å¯': ['åˆ', 'æœª'], 'å£¬è¾°': ['åˆ', 'æœª'], 'ç™¸å·³': ['åˆ', 'æœª'],
      'ç”²åˆ': ['è¾°', 'å·³'], 'ä¹™æœª': ['è¾°', 'å·³'], 'ä¸™ç”³': ['è¾°', 'å·³'], 'ä¸é…‰': ['è¾°', 'å·³'], 'æˆŠæˆŒ': ['è¾°', 'å·³'],
      'å·±äº¥': ['è¾°', 'å·³'], 'åºšå­': ['è¾°', 'å·³'], 'è¾›ä¸‘': ['è¾°', 'å·³'], 'å£¬å¯…': ['è¾°', 'å·³'], 'ç™¸å¯': ['è¾°', 'å·³'],
      'ç”²è¾°': ['å¯…', 'å¯'], 'ä¹™å·³': ['å¯…', 'å¯'], 'ä¸™åˆ': ['å¯…', 'å¯'], 'ä¸æœª': ['å¯…', 'å¯'], 'æˆŠç”³': ['å¯…', 'å¯'],
      'å·±é…‰': ['å¯…', 'å¯'], 'åºšæˆŒ': ['å¯…', 'å¯'], 'è¾›äº¥': ['å¯…', 'å¯'], 'å£¬å­': ['å¯…', 'å¯'], 'ç™¸ä¸‘': ['å¯…', 'å¯'],
      'ç”²å¯…': ['å­', 'ä¸‘'], 'ä¹™å¯': ['å­', 'ä¸‘'], 'ä¸™è¾°': ['å­', 'ä¸‘'], 'ä¸å·³': ['å­', 'ä¸‘'], 'æˆŠåˆ': ['å­', 'ä¸‘'],
      'å·±æœª': ['å­', 'ä¸‘'], 'åºšç”³': ['å­', 'ä¸‘'], 'è¾›é…‰': ['å­', 'ä¸‘'], 'å£¬æˆŒ': ['å­', 'ä¸‘'], 'ç™¸äº¥': ['å­', 'ä¸‘']
    };

    return xunMap[hourGanZhi]?.includes(branch) || false;
  }

  /**
   * åˆ¤æ–­å‘½å®«ç©ºäº¡
   * @param mingGongStem å‘½å®«å¹²
   * @param mingGongBranch å‘½å®«æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå‘½å®«ç©ºäº¡
   */
  static isMingGongKongWang(mingGongStem: string, mingGongBranch: string, branch: string): boolean {
    // å‘½å®«ç©ºäº¡ï¼šæ ¹æ®å‘½å®«å¹²æ”¯æŸ¥æ—¬ç©º
    const mingGongGanZhi = mingGongStem + mingGongBranch;

    // å®Œæ•´çš„æ—¬ç©ºæ˜ å°„è¡¨
    const xunMap: {[key: string]: string[]} = {
      'ç”²å­': ['æˆŒ', 'äº¥'], 'ä¹™ä¸‘': ['æˆŒ', 'äº¥'], 'ä¸™å¯…': ['æˆŒ', 'äº¥'], 'ä¸å¯': ['æˆŒ', 'äº¥'], 'æˆŠè¾°': ['æˆŒ', 'äº¥'],
      'å·±å·³': ['æˆŒ', 'äº¥'], 'åºšåˆ': ['æˆŒ', 'äº¥'], 'è¾›æœª': ['æˆŒ', 'äº¥'], 'å£¬ç”³': ['æˆŒ', 'äº¥'], 'ç™¸é…‰': ['æˆŒ', 'äº¥'],
      'ç”²æˆŒ': ['ç”³', 'é…‰'], 'ä¹™äº¥': ['ç”³', 'é…‰'], 'ä¸™å­': ['ç”³', 'é…‰'], 'ä¸ä¸‘': ['ç”³', 'é…‰'], 'æˆŠå¯…': ['ç”³', 'é…‰'],
      'å·±å¯': ['ç”³', 'é…‰'], 'åºšè¾°': ['ç”³', 'é…‰'], 'è¾›å·³': ['ç”³', 'é…‰'], 'å£¬åˆ': ['ç”³', 'é…‰'], 'ç™¸æœª': ['ç”³', 'é…‰'],
      'ç”²ç”³': ['åˆ', 'æœª'], 'ä¹™é…‰': ['åˆ', 'æœª'], 'ä¸™æˆŒ': ['åˆ', 'æœª'], 'ä¸äº¥': ['åˆ', 'æœª'], 'æˆŠå­': ['åˆ', 'æœª'],
      'å·±ä¸‘': ['åˆ', 'æœª'], 'åºšå¯…': ['åˆ', 'æœª'], 'è¾›å¯': ['åˆ', 'æœª'], 'å£¬è¾°': ['åˆ', 'æœª'], 'ç™¸å·³': ['åˆ', 'æœª'],
      'ç”²åˆ': ['è¾°', 'å·³'], 'ä¹™æœª': ['è¾°', 'å·³'], 'ä¸™ç”³': ['è¾°', 'å·³'], 'ä¸é…‰': ['è¾°', 'å·³'], 'æˆŠæˆŒ': ['è¾°', 'å·³'],
      'å·±äº¥': ['è¾°', 'å·³'], 'åºšå­': ['è¾°', 'å·³'], 'è¾›ä¸‘': ['è¾°', 'å·³'], 'å£¬å¯…': ['è¾°', 'å·³'], 'ç™¸å¯': ['è¾°', 'å·³'],
      'ç”²è¾°': ['å¯…', 'å¯'], 'ä¹™å·³': ['å¯…', 'å¯'], 'ä¸™åˆ': ['å¯…', 'å¯'], 'ä¸æœª': ['å¯…', 'å¯'], 'æˆŠç”³': ['å¯…', 'å¯'],
      'å·±é…‰': ['å¯…', 'å¯'], 'åºšæˆŒ': ['å¯…', 'å¯'], 'è¾›äº¥': ['å¯…', 'å¯'], 'å£¬å­': ['å¯…', 'å¯'], 'ç™¸ä¸‘': ['å¯…', 'å¯'],
      'ç”²å¯…': ['å­', 'ä¸‘'], 'ä¹™å¯': ['å­', 'ä¸‘'], 'ä¸™è¾°': ['å­', 'ä¸‘'], 'ä¸å·³': ['å­', 'ä¸‘'], 'æˆŠåˆ': ['å­', 'ä¸‘'],
      'å·±æœª': ['å­', 'ä¸‘'], 'åºšç”³': ['å­', 'ä¸‘'], 'è¾›é…‰': ['å­', 'ä¸‘'], 'å£¬æˆŒ': ['å­', 'ä¸‘'], 'ç™¸äº¥': ['å­', 'ä¸‘']
    };

    return xunMap[mingGongGanZhi]?.includes(branch) || false;
  }

  /**
   * åˆ¤æ–­èº«å®«ç©ºäº¡
   * @param shenGongStem èº«å®«å¹²
   * @param shenGongBranch èº«å®«æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºèº«å®«ç©ºäº¡
   */
  static isShenGongKongWang(shenGongStem: string, shenGongBranch: string, branch: string): boolean {
    // èº«å®«ç©ºäº¡ï¼šæ ¹æ®èº«å®«å¹²æ”¯æŸ¥æ—¬ç©º
    const shenGongGanZhi = shenGongStem + shenGongBranch;

    // å®Œæ•´çš„æ—¬ç©ºæ˜ å°„è¡¨
    const xunMap: {[key: string]: string[]} = {
      'ç”²å­': ['æˆŒ', 'äº¥'], 'ä¹™ä¸‘': ['æˆŒ', 'äº¥'], 'ä¸™å¯…': ['æˆŒ', 'äº¥'], 'ä¸å¯': ['æˆŒ', 'äº¥'], 'æˆŠè¾°': ['æˆŒ', 'äº¥'],
      'å·±å·³': ['æˆŒ', 'äº¥'], 'åºšåˆ': ['æˆŒ', 'äº¥'], 'è¾›æœª': ['æˆŒ', 'äº¥'], 'å£¬ç”³': ['æˆŒ', 'äº¥'], 'ç™¸é…‰': ['æˆŒ', 'äº¥'],
      'ç”²æˆŒ': ['ç”³', 'é…‰'], 'ä¹™äº¥': ['ç”³', 'é…‰'], 'ä¸™å­': ['ç”³', 'é…‰'], 'ä¸ä¸‘': ['ç”³', 'é…‰'], 'æˆŠå¯…': ['ç”³', 'é…‰'],
      'å·±å¯': ['ç”³', 'é…‰'], 'åºšè¾°': ['ç”³', 'é…‰'], 'è¾›å·³': ['ç”³', 'é…‰'], 'å£¬åˆ': ['ç”³', 'é…‰'], 'ç™¸æœª': ['ç”³', 'é…‰'],
      'ç”²ç”³': ['åˆ', 'æœª'], 'ä¹™é…‰': ['åˆ', 'æœª'], 'ä¸™æˆŒ': ['åˆ', 'æœª'], 'ä¸äº¥': ['åˆ', 'æœª'], 'æˆŠå­': ['åˆ', 'æœª'],
      'å·±ä¸‘': ['åˆ', 'æœª'], 'åºšå¯…': ['åˆ', 'æœª'], 'è¾›å¯': ['åˆ', 'æœª'], 'å£¬è¾°': ['åˆ', 'æœª'], 'ç™¸å·³': ['åˆ', 'æœª'],
      'ç”²åˆ': ['è¾°', 'å·³'], 'ä¹™æœª': ['è¾°', 'å·³'], 'ä¸™ç”³': ['è¾°', 'å·³'], 'ä¸é…‰': ['è¾°', 'å·³'], 'æˆŠæˆŒ': ['è¾°', 'å·³'],
      'å·±äº¥': ['è¾°', 'å·³'], 'åºšå­': ['è¾°', 'å·³'], 'è¾›ä¸‘': ['è¾°', 'å·³'], 'å£¬å¯…': ['è¾°', 'å·³'], 'ç™¸å¯': ['è¾°', 'å·³'],
      'ç”²è¾°': ['å¯…', 'å¯'], 'ä¹™å·³': ['å¯…', 'å¯'], 'ä¸™åˆ': ['å¯…', 'å¯'], 'ä¸æœª': ['å¯…', 'å¯'], 'æˆŠç”³': ['å¯…', 'å¯'],
      'å·±é…‰': ['å¯…', 'å¯'], 'åºšæˆŒ': ['å¯…', 'å¯'], 'è¾›äº¥': ['å¯…', 'å¯'], 'å£¬å­': ['å¯…', 'å¯'], 'ç™¸ä¸‘': ['å¯…', 'å¯'],
      'ç”²å¯…': ['å­', 'ä¸‘'], 'ä¹™å¯': ['å­', 'ä¸‘'], 'ä¸™è¾°': ['å­', 'ä¸‘'], 'ä¸å·³': ['å­', 'ä¸‘'], 'æˆŠåˆ': ['å­', 'ä¸‘'],
      'å·±æœª': ['å­', 'ä¸‘'], 'åºšç”³': ['å­', 'ä¸‘'], 'è¾›é…‰': ['å­', 'ä¸‘'], 'å£¬æˆŒ': ['å­', 'ä¸‘'], 'ç™¸äº¥': ['å­', 'ä¸‘']
    };

    return xunMap[shenGongGanZhi]?.includes(branch) || false;
  }

  /**
   * åˆ¤æ–­èƒå…ƒç©ºäº¡
   * @param taiYuanStem èƒå…ƒå¹²
   * @param taiYuanBranch èƒå…ƒæ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºèƒå…ƒç©ºäº¡
   */
  static isTaiYuanKongWang(taiYuanStem: string, taiYuanBranch: string, branch: string): boolean {
    // èƒå…ƒç©ºäº¡ï¼šæ ¹æ®èƒå…ƒå¹²æ”¯æŸ¥æ—¬ç©º
    const taiYuanGanZhi = taiYuanStem + taiYuanBranch;

    // å®Œæ•´çš„æ—¬ç©ºæ˜ å°„è¡¨
    const xunMap: {[key: string]: string[]} = {
      'ç”²å­': ['æˆŒ', 'äº¥'], 'ä¹™ä¸‘': ['æˆŒ', 'äº¥'], 'ä¸™å¯…': ['æˆŒ', 'äº¥'], 'ä¸å¯': ['æˆŒ', 'äº¥'], 'æˆŠè¾°': ['æˆŒ', 'äº¥'],
      'å·±å·³': ['æˆŒ', 'äº¥'], 'åºšåˆ': ['æˆŒ', 'äº¥'], 'è¾›æœª': ['æˆŒ', 'äº¥'], 'å£¬ç”³': ['æˆŒ', 'äº¥'], 'ç™¸é…‰': ['æˆŒ', 'äº¥'],
      'ç”²æˆŒ': ['ç”³', 'é…‰'], 'ä¹™äº¥': ['ç”³', 'é…‰'], 'ä¸™å­': ['ç”³', 'é…‰'], 'ä¸ä¸‘': ['ç”³', 'é…‰'], 'æˆŠå¯…': ['ç”³', 'é…‰'],
      'å·±å¯': ['ç”³', 'é…‰'], 'åºšè¾°': ['ç”³', 'é…‰'], 'è¾›å·³': ['ç”³', 'é…‰'], 'å£¬åˆ': ['ç”³', 'é…‰'], 'ç™¸æœª': ['ç”³', 'é…‰'],
      'ç”²ç”³': ['åˆ', 'æœª'], 'ä¹™é…‰': ['åˆ', 'æœª'], 'ä¸™æˆŒ': ['åˆ', 'æœª'], 'ä¸äº¥': ['åˆ', 'æœª'], 'æˆŠå­': ['åˆ', 'æœª'],
      'å·±ä¸‘': ['åˆ', 'æœª'], 'åºšå¯…': ['åˆ', 'æœª'], 'è¾›å¯': ['åˆ', 'æœª'], 'å£¬è¾°': ['åˆ', 'æœª'], 'ç™¸å·³': ['åˆ', 'æœª'],
      'ç”²åˆ': ['è¾°', 'å·³'], 'ä¹™æœª': ['è¾°', 'å·³'], 'ä¸™ç”³': ['è¾°', 'å·³'], 'ä¸é…‰': ['è¾°', 'å·³'], 'æˆŠæˆŒ': ['è¾°', 'å·³'],
      'å·±äº¥': ['è¾°', 'å·³'], 'åºšå­': ['è¾°', 'å·³'], 'è¾›ä¸‘': ['è¾°', 'å·³'], 'å£¬å¯…': ['è¾°', 'å·³'], 'ç™¸å¯': ['è¾°', 'å·³'],
      'ç”²è¾°': ['å¯…', 'å¯'], 'ä¹™å·³': ['å¯…', 'å¯'], 'ä¸™åˆ': ['å¯…', 'å¯'], 'ä¸æœª': ['å¯…', 'å¯'], 'æˆŠç”³': ['å¯…', 'å¯'],
      'å·±é…‰': ['å¯…', 'å¯'], 'åºšæˆŒ': ['å¯…', 'å¯'], 'è¾›äº¥': ['å¯…', 'å¯'], 'å£¬å­': ['å¯…', 'å¯'], 'ç™¸ä¸‘': ['å¯…', 'å¯'],
      'ç”²å¯…': ['å­', 'ä¸‘'], 'ä¹™å¯': ['å­', 'ä¸‘'], 'ä¸™è¾°': ['å­', 'ä¸‘'], 'ä¸å·³': ['å­', 'ä¸‘'], 'æˆŠåˆ': ['å­', 'ä¸‘'],
      'å·±æœª': ['å­', 'ä¸‘'], 'åºšç”³': ['å­', 'ä¸‘'], 'è¾›é…‰': ['å­', 'ä¸‘'], 'å£¬æˆŒ': ['å­', 'ä¸‘'], 'ç™¸äº¥': ['å­', 'ä¸‘']
    };

    return xunMap[taiYuanGanZhi]?.includes(branch) || false;
  }

  /**
   * ç»¼åˆç©ºäº¡åˆ¤æ–­ - æ£€æŸ¥æ‰€æœ‰æŸ±çš„ç©ºäº¡æƒ…å†µ
   * @param params åŒ…å«æ‰€æœ‰æŸ±ä¿¡æ¯çš„å‚æ•°å¯¹è±¡
   * @param branch è¦æ£€æŸ¥çš„åœ°æ”¯
   * @returns ç©ºäº¡è¯¦æƒ…å¯¹è±¡
   */
  static getKongWangDetails(params: {
    yearStem: string, yearBranch: string,
    monthStem: string, monthBranch: string,
    dayStem: string, dayBranch: string,
    hourStem: string, hourBranch: string,
    mingGongStem?: string, mingGongBranch?: string,
    shenGongStem?: string, shenGongBranch?: string,
    taiYuanStem?: string, taiYuanBranch?: string
  }, branch: string): {
    hasKongWang: boolean,
    details: {
      å¹´ç©º: boolean,
      æœˆç©º: boolean,
      æ—¥ç©º: boolean,
      æ—¶ç©º: boolean,
      å‘½å®«ç©º?: boolean,
      èº«å®«ç©º?: boolean,
      èƒå…ƒç©º?: boolean
    }
  } {
    const details = {
      å¹´ç©º: ShenShaAlgorithms.isNianKongWang(params.yearStem, params.yearBranch, branch),
      æœˆç©º: ShenShaAlgorithms.isYueKongWang(params.monthStem, params.monthBranch, branch),
      æ—¥ç©º: ShenShaAlgorithms.isRiKongWang(params.dayStem, params.dayBranch, branch),
      æ—¶ç©º: ShenShaAlgorithms.isShiKongWang(params.hourStem, params.hourBranch, branch)
    };

    // å¯é€‰çš„å‘½å®«ã€èº«å®«ã€èƒå…ƒç©ºäº¡æ£€æŸ¥
    if (params.mingGongStem && params.mingGongBranch) {
      details['å‘½å®«ç©º'] = ShenShaAlgorithms.isMingGongKongWang(params.mingGongStem, params.mingGongBranch, branch);
    }

    if (params.shenGongStem && params.shenGongBranch) {
      details['èº«å®«ç©º'] = ShenShaAlgorithms.isShenGongKongWang(params.shenGongStem, params.shenGongBranch, branch);
    }

    if (params.taiYuanStem && params.taiYuanBranch) {
      details['èƒå…ƒç©º'] = ShenShaAlgorithms.isTaiYuanKongWang(params.taiYuanStem, params.taiYuanBranch, branch);
    }

    const hasKongWang = Object.values(details).some(value => value === true);

    return {
      hasKongWang,
      details
    };
  }

  /**
   * åˆ¤æ–­å¤ªæè´µäºº
   * @param dayStem æ—¥å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤ªæè´µäºº
   */
  static isTaiJiGuiRen(dayStem: string, branch: string): boolean {
    // å¤ªæè´µäººçš„è®¡ç®—è§„åˆ™ï¼š
    // ç”²ä¹™æ—¥å¹²è§å­åˆï¼Œä¸™ä¸æ—¥å¹²è§é…‰å¯ï¼ŒæˆŠå·±æ—¥å¹²è§è¾°æˆŒä¸‘æœªï¼Œåºšè¾›æ—¥å¹²è§å¯…äº¥ï¼Œå£¬ç™¸æ—¥å¹²è§å·³ç”³
    const map: {[key: string]: string[]} = {
      'ç”²': ['å­', 'åˆ'], 'ä¹™': ['å­', 'åˆ'],
      'ä¸™': ['é…‰', 'å¯'], 'ä¸': ['é…‰', 'å¯'],
      'æˆŠ': ['è¾°', 'æˆŒ', 'ä¸‘', 'æœª'], 'å·±': ['è¾°', 'æˆŒ', 'ä¸‘', 'æœª'],
      'åºš': ['å¯…', 'äº¥'], 'è¾›': ['å¯…', 'äº¥'],
      'å£¬': ['å·³', 'ç”³'], 'ç™¸': ['å·³', 'ç”³']
    };
    return map[dayStem]?.includes(branch) || false;
  }

  /**
   * åˆ¤æ–­é‡‘èˆ†
   * @param dayStem æ—¥å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºé‡‘èˆ†
   */
  static isJinYu(dayStem: string, branch: string): boolean {
    // é‡‘èˆ†çš„è®¡ç®—è§„åˆ™ï¼š
    // ç”²æ—¥å¹²é‡‘èˆ†åœ¨è¾°ï¼Œä¹™æ—¥å¹²é‡‘èˆ†åœ¨å·³ï¼Œä¸™æˆŠæ—¥å¹²é‡‘èˆ†åœ¨æœªï¼Œä¸å·±æ—¥å¹²é‡‘èˆ†åœ¨ç”³ï¼Œ
    // åºšæ—¥å¹²é‡‘èˆ†åœ¨æˆŒï¼Œè¾›æ—¥å¹²é‡‘èˆ†åœ¨äº¥ï¼Œå£¬æ—¥å¹²é‡‘èˆ†åœ¨ä¸‘ï¼Œç™¸æ—¥å¹²é‡‘èˆ†åœ¨å¯…
    const map: {[key: string]: string} = {
      'ç”²': 'è¾°', 'ä¹™': 'å·³', 'ä¸™': 'æœª', 'æˆŠ': 'æœª',
      'ä¸': 'ç”³', 'å·±': 'ç”³', 'åºš': 'æˆŒ', 'è¾›': 'äº¥',
      'å£¬': 'ä¸‘', 'ç™¸': 'å¯…'
    };
    return map[dayStem] === branch;
  }

  /**
   * åˆ¤æ–­å›½å°è´µäºº
   * @param stem å¤©å¹²ï¼ˆå¹´å¹²æˆ–æ—¥å¹²ï¼‰
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå›½å°è´µäºº
   */
  static isGuoYinGuiRen(stem: string, branch: string): boolean {
    // å›½å°è´µäººçš„è®¡ç®—è§„åˆ™ï¼š
    // ç”²è§æˆŒï¼Œä¹™è§äº¥ï¼Œä¸™è§ä¸‘ï¼Œä¸è§å¯…ï¼ŒæˆŠè§ä¸‘ï¼Œå·±è§å¯…ï¼Œåºšè§è¾°ï¼Œè¾›è§å·³ï¼Œå£¬è§æœªï¼Œç™¸è§ç”³
    const map: {[key: string]: string} = {
      'ç”²': 'æˆŒ', 'ä¹™': 'äº¥', 'ä¸™': 'ä¸‘', 'ä¸': 'å¯…',
      'æˆŠ': 'ä¸‘', 'å·±': 'å¯…', 'åºš': 'è¾°', 'è¾›': 'å·³',
      'å£¬': 'æœª', 'ç™¸': 'ç”³'
    };
    return map[stem] === branch;
  }

  /**
   * åˆ¤æ–­ä¸‰å¥‡è´µäºº
   * @param stems å¤©å¹²æ•°ç»„ï¼ˆè¿ç»­çš„ä¸‰ä¸ªå¤©å¹²ï¼‰
   * @returns æ˜¯å¦ä¸ºä¸‰å¥‡è´µäºº
   */
  static isSanQiGuiRen(stems: string[]): boolean {
    if (stems.length < 3) return false;

    // ä¸‰å¥‡è´µäººçš„è®¡ç®—è§„åˆ™ï¼š
    // å¤©ä¸Šä¸‰å¥‡ä¹™ä¸™ä¸ï¼›åœ°ä¸‹ä¸‰å¥‡ç”²æˆŠåºšï¼›äººä¸­ä¸‰å¥‡å£¬ç™¸è¾›
    const tianShangSanQi = ['ä¹™', 'ä¸™', 'ä¸'];
    const diXiaSanQi = ['ç”²', 'æˆŠ', 'åºš'];
    const renZhongSanQi = ['å£¬', 'ç™¸', 'è¾›'];

    // æ£€æŸ¥æ˜¯å¦åŒ…å«ä»»ä¸€ç»„ä¸‰å¥‡
    for (let i = 0; i <= stems.length - 3; i++) {
      const threeStem = stems.slice(i, i + 3);
      if (ShenShaAlgorithms.arrayEquals(threeStem, tianShangSanQi) ||
          ShenShaAlgorithms.arrayEquals(threeStem, diXiaSanQi) ||
          ShenShaAlgorithms.arrayEquals(threeStem, renZhongSanQi)) {
        return true;
      }
    }
    return false;
  }

  /**
   * åˆ¤æ–­ç¦æ˜Ÿè´µäºº
   * @param dayStem æ—¥å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºç¦æ˜Ÿè´µäºº
   */
  static isFuXingGuiRen(dayStem: string, branch: string): boolean {
    // ç¦æ˜Ÿè´µäººçš„è®¡ç®—è§„åˆ™ï¼š
    // ç”²ä¸™ä¸¤å¹²è§å¯…æˆ–å­ï¼Œä¹™ç™¸ä¸¤å¹²è§å¯æˆ–ä¸‘ï¼ŒæˆŠå¹²è§ç”³ï¼Œå·±å¹²è§æœªï¼Œä¸å¹²è§äº¥ï¼Œåºšå¹²è§åˆï¼Œè¾›å¹²è§å·³ï¼Œå£¬å¹²è§è¾°
    const map: {[key: string]: string[]} = {
      'ç”²': ['å¯…', 'å­'], 'ä¸™': ['å¯…', 'å­'],
      'ä¹™': ['å¯', 'ä¸‘'], 'ç™¸': ['å¯', 'ä¸‘'],
      'æˆŠ': ['ç”³'], 'å·±': ['æœª'], 'ä¸': ['äº¥'],
      'åºš': ['åˆ'], 'è¾›': ['å·³'], 'å£¬': ['è¾°']
    };
    return map[dayStem]?.includes(branch) || false;
  }

  /**
   * åˆ¤æ–­æ–‡æ›²
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºæ–‡æ›²
   */
  static isWenQu(yearBranch: string, branch: string): boolean {
    // æ–‡æ›²çš„è®¡ç®—è§„åˆ™ï¼š
    // å¯…åˆæˆŒå¹´æ”¯è§ä¸‘ï¼Œç”³å­è¾°å¹´æ”¯è§æœªï¼Œäº¥å¯æœªå¹´æ”¯è§è¾°ï¼Œå·³é…‰ä¸‘å¹´æ”¯è§æˆŒ
    const map: {[key: string]: string} = {
      'å¯…': 'ä¸‘', 'åˆ': 'ä¸‘', 'æˆŒ': 'ä¸‘',
      'ç”³': 'æœª', 'å­': 'æœª', 'è¾°': 'æœª',
      'äº¥': 'è¾°', 'å¯': 'è¾°', 'æœª': 'è¾°',
      'å·³': 'æˆŒ', 'é…‰': 'æˆŒ', 'ä¸‘': 'æˆŒ'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­å¤©å–œ
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©å–œ
   */
  static isTianXi(yearBranch: string, branch: string): boolean {
    // å¤©å–œçš„è®¡ç®—è§„åˆ™ï¼š
    // å­å¹´æ”¯å¤©å–œåœ¨é…‰ï¼Œä¸‘å¹´æ”¯å¤©å–œåœ¨ç”³ï¼Œå¯…å¹´æ”¯å¤©å–œåœ¨æœªï¼Œå¯å¹´æ”¯å¤©å–œåœ¨åˆï¼Œ
    // è¾°å¹´æ”¯å¤©å–œåœ¨å·³ï¼Œå·³å¹´æ”¯å¤©å–œåœ¨è¾°ï¼Œåˆå¹´æ”¯å¤©å–œåœ¨å¯ï¼Œæœªå¹´æ”¯å¤©å–œåœ¨å¯…ï¼Œ
    // ç”³å¹´æ”¯å¤©å–œåœ¨ä¸‘ï¼Œé…‰å¹´æ”¯å¤©å–œåœ¨å­ï¼ŒæˆŒå¹´æ”¯å¤©å–œåœ¨äº¥ï¼Œäº¥å¹´æ”¯å¤©å–œåœ¨æˆŒ
    const map: {[key: string]: string} = {
      'å­': 'é…‰', 'ä¸‘': 'ç”³', 'å¯…': 'æœª', 'å¯': 'åˆ',
      'è¾°': 'å·³', 'å·³': 'è¾°', 'åˆ': 'å¯', 'æœª': 'å¯…',
      'ç”³': 'ä¸‘', 'é…‰': 'å­', 'æˆŒ': 'äº¥', 'äº¥': 'æˆŒ'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­çº¢é¸¾
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºçº¢é¸¾
   */
  static isHongLuan(yearBranch: string, branch: string): boolean {
    // çº¢é¸¾çš„è®¡ç®—è§„åˆ™ï¼šä¸å¤©å–œç›¸åŒ
    // å­å¹´æ”¯çº¢é¸¾åœ¨é…‰ï¼Œä¸‘å¹´æ”¯çº¢é¸¾åœ¨ç”³ï¼Œå¯…å¹´æ”¯çº¢é¸¾åœ¨æœªï¼Œå¯å¹´æ”¯çº¢é¸¾åœ¨åˆï¼Œ
    // è¾°å¹´æ”¯çº¢é¸¾åœ¨å·³ï¼Œå·³å¹´æ”¯çº¢é¸¾åœ¨è¾°ï¼Œåˆå¹´æ”¯çº¢é¸¾åœ¨å¯ï¼Œæœªå¹´æ”¯çº¢é¸¾åœ¨å¯…ï¼Œ
    // ç”³å¹´æ”¯çº¢é¸¾åœ¨ä¸‘ï¼Œé…‰å¹´æ”¯çº¢é¸¾åœ¨å­ï¼ŒæˆŒå¹´æ”¯çº¢é¸¾åœ¨äº¥ï¼Œäº¥å¹´æ”¯çº¢é¸¾åœ¨æˆŒ
    return ShenShaAlgorithms.isTianXi(yearBranch, branch);
  }

  /**
   * åˆ¤æ–­çº¢è‰³
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºçº¢è‰³
   */
  static isHongYan(yearBranch: string, branch: string): boolean {
    // çº¢è‰³çš„è®¡ç®—è§„åˆ™ï¼šä¸å¤©å–œã€çº¢é¸¾ç›¸åŒ
    return ShenShaAlgorithms.isTianXi(yearBranch, branch);
  }

  /**
   * åˆ¤æ–­å¤©å§š
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©å§š
   */
  static isTianYao(yearBranch: string, branch: string): boolean {
    // å¤©å§šçš„è®¡ç®—è§„åˆ™ï¼š
    // å­å¹´æ”¯å¤©å§šåœ¨å·³ï¼Œä¸‘å¹´æ”¯å¤©å§šåœ¨åˆï¼Œå¯…å¹´æ”¯å¤©å§šåœ¨æœªï¼Œå¯å¹´æ”¯å¤©å§šåœ¨ç”³ï¼Œ
    // è¾°å¹´æ”¯å¤©å§šåœ¨é…‰ï¼Œå·³å¹´æ”¯å¤©å§šåœ¨æˆŒï¼Œåˆå¹´æ”¯å¤©å§šåœ¨äº¥ï¼Œæœªå¹´æ”¯å¤©å§šåœ¨å­ï¼Œ
    // ç”³å¹´æ”¯å¤©å§šåœ¨ä¸‘ï¼Œé…‰å¹´æ”¯å¤©å§šåœ¨å¯…ï¼ŒæˆŒå¹´æ”¯å¤©å§šåœ¨å¯ï¼Œäº¥å¹´æ”¯å¤©å§šåœ¨è¾°
    const map: {[key: string]: string} = {
      'å­': 'å·³', 'ä¸‘': 'åˆ', 'å¯…': 'æœª', 'å¯': 'ç”³',
      'è¾°': 'é…‰', 'å·³': 'æˆŒ', 'åˆ': 'äº¥', 'æœª': 'å­',
      'ç”³': 'ä¸‘', 'é…‰': 'å¯…', 'æˆŒ': 'å¯', 'äº¥': 'è¾°'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­å­¦å ‚è¯é¦†
   * @param dayStem æ—¥å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå­¦å ‚è¯é¦†
   */
  static isXueTangCiGuan(dayStem: string, branch: string): boolean {
    // å­¦å ‚è¯é¦†çš„è®¡ç®—è§„åˆ™ï¼š
    // ç”²è§å¯ä¹™è§è¾°ï¼Œä¸™æˆŠè§å·³ä¸å·±è§åˆï¼Œåºšè§ç”³è¾›è§é…‰ï¼Œå£¬è§äº¥ç™¸è§å­
    const map: {[key: string]: string} = {
      'ç”²': 'å¯', 'ä¹™': 'è¾°', 'ä¸™': 'å·³', 'æˆŠ': 'å·³',
      'ä¸': 'åˆ', 'å·±': 'åˆ', 'åºš': 'ç”³', 'è¾›': 'é…‰',
      'å£¬': 'äº¥', 'ç™¸': 'å­'
    };
    return map[dayStem] === branch;
  }

  /**
   * åˆ¤æ–­å¾·ç§€è´µäºº
   * @param monthBranch æœˆæ”¯
   * @param stem å¤©å¹²
   * @returns æ˜¯å¦ä¸ºå¾·ç§€è´µäºº
   */
  static isDeXiuGuiRen(monthBranch: string, stem: string): boolean {
    // å¾·ç§€è´µäººçš„è®¡ç®—è§„åˆ™ï¼š
    // å¯…åˆæˆŒæœˆä¸™ä¸ä¸ºå¾·æˆŠç™¸ä¸ºç§€ï¼Œç”³å­è¾°æœˆå£¬ç™¸æˆŠå·±ä¸ºå¾·ä¸™è¾›ç”²å·±ä¸ºç§€ï¼Œ
    // å·³é…‰ä¸‘æœˆåºšè¾›ä¸ºå¾·ä¹™åºšä¸ºç§€ï¼Œäº¥å¯æœªæœˆç”²ä¹™ä¸ºå¾·ä¸å£¬ä¸ºç§€
    const deMap: {[key: string]: string[]} = {
      'å¯…': ['ä¸™', 'ä¸'], 'åˆ': ['ä¸™', 'ä¸'], 'æˆŒ': ['ä¸™', 'ä¸'],
      'ç”³': ['å£¬', 'ç™¸', 'æˆŠ', 'å·±'], 'å­': ['å£¬', 'ç™¸', 'æˆŠ', 'å·±'], 'è¾°': ['å£¬', 'ç™¸', 'æˆŠ', 'å·±'],
      'å·³': ['åºš', 'è¾›'], 'é…‰': ['åºš', 'è¾›'], 'ä¸‘': ['åºš', 'è¾›'],
      'äº¥': ['ç”²', 'ä¹™'], 'å¯': ['ç”²', 'ä¹™'], 'æœª': ['ç”²', 'ä¹™']
    };

    const xiuMap: {[key: string]: string[]} = {
      'å¯…': ['æˆŠ', 'ç™¸'], 'åˆ': ['æˆŠ', 'ç™¸'], 'æˆŒ': ['æˆŠ', 'ç™¸'],
      'ç”³': ['ä¸™', 'è¾›', 'ç”²', 'å·±'], 'å­': ['ä¸™', 'è¾›', 'ç”²', 'å·±'], 'è¾°': ['ä¸™', 'è¾›', 'ç”²', 'å·±'],
      'å·³': ['ä¹™', 'åºš'], 'é…‰': ['ä¹™', 'åºš'], 'ä¸‘': ['ä¹™', 'åºš'],
      'äº¥': ['ä¸', 'å£¬'], 'å¯': ['ä¸', 'å£¬'], 'æœª': ['ä¸', 'å£¬']
    };

    return (deMap[monthBranch]?.includes(stem) || xiuMap[monthBranch]?.includes(stem)) || false;
  }

  /**
   * åˆ¤æ–­åæ¶å¤§è´¥
   * @param dayStem æ—¥å¹²
   * @param dayBranch æ—¥æ”¯
   * @returns æ˜¯å¦ä¸ºåæ¶å¤§è´¥
   */
  static isShiEDaBai(dayStem: string, dayBranch: string): boolean {
    // åæ¶å¤§è´¥çš„è®¡ç®—è§„åˆ™ï¼šç‰¹å®šçš„æ—¥æŸ±ç»„åˆ
    // ç”²è¾°ã€ä¹™å·³ã€ä¸™ç”³ã€ä¸äº¥ã€æˆŠæˆŒã€å·±ä¸‘ã€åºšè¾°ã€è¾›å·³ã€å£¬ç”³ã€ç™¸äº¥æ—¥æŸ±
    const shiEDaBaiList = [
      'ç”²è¾°', 'ä¹™å·³', 'ä¸™ç”³', 'ä¸äº¥', 'æˆŠæˆŒ',
      'å·±ä¸‘', 'åºšè¾°', 'è¾›å·³', 'å£¬ç”³', 'ç™¸äº¥'
    ];
    return shiEDaBaiList.includes(dayStem + dayBranch);
  }

  /**
   * åˆ¤æ–­å­¤é¸¾ç…
   * @param dayStem æ—¥å¹²
   * @param dayBranch æ—¥æ”¯
   * @returns æ˜¯å¦ä¸ºå­¤é¸¾ç…
   */
  static isGuLuanSha(dayStem: string, dayBranch: string): boolean {
    // å­¤é¸¾ç…çš„è®¡ç®—è§„åˆ™ï¼šç‰¹å®šçš„æ—¥æŸ±ç»„åˆ
    // ä¹™å·³ï¼Œä¸å·³ï¼Œè¾›äº¥ï¼ŒæˆŠç”³ï¼Œå£¬å¯…ï¼ŒæˆŠåˆï¼Œå£¬å­ï¼Œä¸™åˆæ—¥æŸ±ä¸ºå­¤é¸¾ç…
    const guLuanShaList = [
      'ä¹™å·³', 'ä¸å·³', 'è¾›äº¥', 'æˆŠç”³',
      'å£¬å¯…', 'æˆŠåˆ', 'å£¬å­', 'ä¸™åˆ'
    ];
    return guLuanShaList.includes(dayStem + dayBranch);
  }

  /**
   * åˆ¤æ–­å››åºŸ
   * @param season å­£èŠ‚ï¼ˆæ˜¥å¤ç§‹å†¬ï¼‰
   * @param dayStem æ—¥å¹²
   * @param dayBranch æ—¥æ”¯
   * @returns æ˜¯å¦ä¸ºå››åºŸ
   */
  static isSiFei(season: string, dayStem: string, dayBranch: string): boolean {
    // å››åºŸçš„è®¡ç®—è§„åˆ™ï¼š
    // æ˜¥åºšç”³ï¼Œè¾›é…‰ï¼Œå¤å£¬å­ï¼Œç™¸äº¥ï¼Œç§‹ç”²å¯…ï¼Œä¹™å¯ï¼Œå†¬ä¸™åˆï¼Œä¸å·³
    const siFeiMap: {[key: string]: string[]} = {
      'æ˜¥': ['åºšç”³', 'è¾›é…‰'],
      'å¤': ['å£¬å­', 'ç™¸äº¥'],
      'ç§‹': ['ç”²å¯…', 'ä¹™å¯'],
      'å†¬': ['ä¸™åˆ', 'ä¸å·³']
    };
    return siFeiMap[season]?.includes(dayStem + dayBranch) || false;
  }

  /**
   * åˆ¤æ–­å¤©ç½—åœ°ç½‘
   * @param nayin çº³éŸ³äº”è¡Œ
   * @param dayStem æ—¥å¹²
   * @param dayBranch æ—¥æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©ç½—åœ°ç½‘
   */
  static isTianLuoDiWang(nayin: string, dayStem: string, dayBranch: string): boolean {
    // å¤©ç½—åœ°ç½‘çš„è®¡ç®—è§„åˆ™ï¼š
    // æˆŒäº¥ä¸ºå¤©ç½—ï¼Œè¾°å·³ä¸ºåœ°ç½‘
    // å‡¡çº³éŸ³ç«å‘½ï¼Œè§æˆŒäº¥æ—¥ä¸ºå¤©ç½—ï¼›çº³éŸ³æ°´åœŸå‘½ï¼Œè§è¾°å·³æ—¥ä¸ºåœ°ç½‘ï¼Œçº³éŸ³é‡‘æœ¨äºŒå‘½æ— ä¹‹
    const dayPillar = dayStem + dayBranch;

    if (nayin === 'ç«') {
      return dayPillar.includes('æˆŒ') || dayPillar.includes('äº¥');
    } else if (nayin === 'æ°´' || nayin === 'åœŸ') {
      return dayPillar.includes('è¾°') || dayPillar.includes('å·³');
    }
    return false;
  }

  /**
   * åˆ¤æ–­äº¡ç¥
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºäº¡ç¥
   */
  static isWangShen(yearBranch: string, branch: string): boolean {
    // äº¡ç¥çš„è®¡ç®—è§„åˆ™ï¼š
    // ç”³å­è¾°è§äº¥ï¼Œå¯…åˆæˆŒè§å·³ï¼Œå·³é…‰ä¸‘è§ç”³ï¼Œäº¥å¯æœªè§å¯…ï¼Œå³ä¸ºäº¡ç¥
    const map: {[key: string]: string} = {
      'ç”³': 'äº¥', 'å­': 'äº¥', 'è¾°': 'äº¥',
      'å¯…': 'å·³', 'åˆ': 'å·³', 'æˆŒ': 'å·³',
      'å·³': 'ç”³', 'é…‰': 'ç”³', 'ä¸‘': 'ç”³',
      'äº¥': 'å¯…', 'å¯': 'å¯…', 'æœª': 'å¯…'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­æŠ«éº»
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºæŠ«éº»
   */
  static isPiMa(yearBranch: string, branch: string): boolean {
    // æŠ«éº»çš„è®¡ç®—è§„åˆ™ï¼šå¹´æ—¥æ”¯åä¸‰ä½ä¸ºæŠ«éº»
    // å­è§é…‰ï¼Œä¸‘è§æˆŒï¼Œå¯…è§äº¥ï¼Œå¯è§å­ï¼Œè¾°è§ä¸‘ï¼Œå·³è§å¯…ï¼Œåˆè§å¯ï¼Œæœªè§è¾°ï¼Œç”³è§å·³ï¼Œé…‰è§åˆï¼ŒæˆŒè§æœªï¼Œäº¥è§ç”³
    const map: {[key: string]: string} = {
      'å­': 'é…‰', 'ä¸‘': 'æˆŒ', 'å¯…': 'äº¥', 'å¯': 'å­',
      'è¾°': 'ä¸‘', 'å·³': 'å¯…', 'åˆ': 'å¯', 'æœª': 'è¾°',
      'ç”³': 'å·³', 'é…‰': 'åˆ', 'æˆŒ': 'æœª', 'äº¥': 'ç”³'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­åŠå®¢
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºåŠå®¢
   */
  static isDiaoKe(yearBranch: string, branch: string): boolean {
    // åŠå®¢çš„è®¡ç®—è§„åˆ™ï¼šå¹´æ”¯åä¸¤ä½ä¸ºåŠå®¢
    // å­è§æˆŒï¼Œä¸‘è§äº¥ï¼Œå¯…è§å­ï¼Œå¯è§ä¸‘ï¼Œè¾°è§å¯…ï¼Œå·³è§å¯ï¼Œåˆè§è¾°ï¼Œæœªè§å·³ï¼Œç”³è§åˆï¼Œé…‰è§æœªï¼ŒæˆŒè§ç”³ï¼Œäº¥è§é…‰
    const map: {[key: string]: string} = {
      'å­': 'æˆŒ', 'ä¸‘': 'äº¥', 'å¯…': 'å­', 'å¯': 'ä¸‘',
      'è¾°': 'å¯…', 'å·³': 'å¯', 'åˆ': 'è¾°', 'æœª': 'å·³',
      'ç”³': 'åˆ', 'é…‰': 'æœª', 'æˆŒ': 'ç”³', 'äº¥': 'é…‰'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­ä¸§é—¨
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºä¸§é—¨
   */
  static isSangMen(yearBranch: string, branch: string): boolean {
    // ä¸§é—¨çš„è®¡ç®—è§„åˆ™ï¼šå¹´æ”¯å‰ä¸¤ä½ä¸ºä¸§é—¨
    // å­è§å¯…ï¼Œä¸‘è§å¯ï¼Œå¯…è§è¾°ï¼Œå¯è§å·³ï¼Œè¾°è§åˆï¼Œå·³è§æœªï¼Œåˆè§ç”³ï¼Œæœªè§é…‰ï¼Œç”³è§æˆŒï¼Œé…‰è§äº¥ï¼ŒæˆŒè§å­ï¼Œäº¥è§ä¸‘
    const map: {[key: string]: string} = {
      'å­': 'å¯…', 'ä¸‘': 'å¯', 'å¯…': 'è¾°', 'å¯': 'å·³',
      'è¾°': 'åˆ', 'å·³': 'æœª', 'åˆ': 'ç”³', 'æœª': 'é…‰',
      'ç”³': 'æˆŒ', 'é…‰': 'äº¥', 'æˆŒ': 'å­', 'äº¥': 'ä¸‘'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­å…ƒè¾°ï¼ˆå¤§è€—ï¼‰
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå…ƒè¾°
   */
  static isYuanChen(yearBranch: string, branch: string): boolean {
    // å…ƒè¾°ï¼ˆå¤§è€—ï¼‰çš„è®¡ç®—è§„åˆ™ï¼š
    // å­å¹´å¤§è€—åœ¨æœªï¼Œä¸‘å¹´å¤§è€—åœ¨ç”³ï¼Œå¯…å¹´å¤§è€—åœ¨é…‰ï¼Œå¯å¹´å¤§è€—åœ¨æˆŒï¼Œè¾°å¹´å¤§è€—åœ¨äº¥ï¼Œå·³å¹´å¤§è€—åœ¨å­ï¼Œ
    // åˆå¹´å¤§è€—åœ¨ä¸‘ï¼Œæœªå¹´å¤§è€—åœ¨å¯…ï¼Œç”³å¹´å¤§è€—åœ¨å¯ï¼Œé…‰å¹´å¤§è€—åœ¨è¾°ï¼ŒæˆŒå¹´å¤§è€—åœ¨å·³ï¼Œäº¥å¹´å¤§è€—åœ¨åˆ
    const map: {[key: string]: string} = {
      'å­': 'æœª', 'ä¸‘': 'ç”³', 'å¯…': 'é…‰', 'å¯': 'æˆŒ',
      'è¾°': 'äº¥', 'å·³': 'å­', 'åˆ': 'ä¸‘', 'æœª': 'å¯…',
      'ç”³': 'å¯', 'é…‰': 'è¾°', 'æˆŒ': 'å·³', 'äº¥': 'åˆ'
    };
    return map[yearBranch] === branch;
  }



  /**
   * åˆ¤æ–­å¤©ç©º
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©ç©º
   */
  static isTianKong(branch: string): boolean {
    return branch === 'æˆŒ';
  }

  /**
   * åˆ¤æ–­åœ°åŠ«
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºåœ°åŠ«
   */
  static isDiJie(branch: string): boolean {
    return branch === 'è¾°';
  }

  /**
   * åˆ¤æ–­å¤©å“­
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©å“­
   */
  static isTianKu(branch: string): boolean {
    return branch === 'æœª';
  }

  /**
   * åˆ¤æ–­å¤©è™š
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©è™š
   */
  static isTianXu(branch: string): boolean {
    return branch === 'ä¸‘';
  }

  /**
   * åˆ¤æ–­å’¸æ± 
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå’¸æ± 
   */
  static isXianChi(branch: string): boolean {
    return ['ä¸‘', 'æœª', 'è¾°', 'æˆŒ'].includes(branch);
  }

  /**
   * åˆ¤æ–­è§£ç¥
   * @param monthBranch æœˆæ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºè§£ç¥
   */
  static isJieShen(monthBranch: string, branch: string): boolean {
    // è§£ç¥çš„è®¡ç®—è§„åˆ™ï¼š
    // æ­£æœˆè§é…‰ï¼ŒäºŒæœˆè§æˆŒï¼Œä¸‰æœˆè§äº¥ï¼Œå››æœˆè§å­ï¼Œäº”æœˆè§ä¸‘ï¼Œå…­æœˆè§å¯…ï¼Œ
    // ä¸ƒæœˆè§å¯ï¼Œå…«æœˆè§è¾°ï¼Œä¹æœˆè§å·³ï¼Œåæœˆè§åˆï¼Œåä¸€æœˆè§æœªï¼ŒåäºŒæœˆè§ç”³
    const map: {[key: string]: string} = {
      'å¯…': 'é…‰', 'å¯': 'æˆŒ', 'è¾°': 'äº¥', 'å·³': 'å­',
      'åˆ': 'ä¸‘', 'æœª': 'å¯…', 'ç”³': 'å¯', 'é…‰': 'è¾°',
      'æˆŒ': 'å·³', 'äº¥': 'åˆ', 'å­': 'æœª', 'ä¸‘': 'ç”³'
    };
    return map[monthBranch] === branch;
  }

  /**
   * åˆ¤æ–­é‡‘ç¥
   * @param dayStem æ—¥å¹²
   * @param dayBranch æ—¥æ”¯
   * @returns æ˜¯å¦ä¸ºé‡‘ç¥
   */
  static isJinShen(dayStem: string, dayBranch: string): boolean {
    // é‡‘ç¥çš„è®¡ç®—è§„åˆ™ï¼šä¹™ä¸‘ã€å·±å·³ã€ç™¸é…‰ä¸‰æ—¥ä¸‰æ—¶
    const jinShenList = ['ä¹™ä¸‘', 'å·±å·³', 'ç™¸é…‰'];
    return jinShenList.includes(dayStem + dayBranch);
  }

  /**
   * åˆ¤æ–­æ—¥å¾·
   * @param dayStem æ—¥å¹²
   * @param dayBranch æ—¥æ”¯
   * @returns æ˜¯å¦ä¸ºæ—¥å¾·
   */
  static isRiDe(dayStem: string, dayBranch: string): boolean {
    // æ—¥å¾·çš„è®¡ç®—è§„åˆ™ï¼šç”²å¯…ã€æˆŠè¾°ã€ä¸™è¾°ã€åºšè¾°ã€å£¬æˆŒ
    const riDeList = ['ç”²å¯…', 'æˆŠè¾°', 'ä¸™è¾°', 'åºšè¾°', 'å£¬æˆŒ'];
    return riDeList.includes(dayStem + dayBranch);
  }

  /**
   * åˆ¤æ–­äº”é¬¼
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºäº”é¬¼
   */
  static isWuGui(yearBranch: string, branch: string): boolean {
    // äº”é¬¼çš„è®¡ç®—è§„åˆ™ï¼šç”³å­è¾°è§å¯ï¼Œå¯…åˆæˆŒè§é…‰ï¼Œå·³é…‰ä¸‘è§å­ï¼Œäº¥å¯æœªè§åˆ
    const map: {[key: string]: string} = {
      'ç”³': 'å¯', 'å­': 'å¯', 'è¾°': 'å¯',
      'å¯…': 'é…‰', 'åˆ': 'é…‰', 'æˆŒ': 'é…‰',
      'å·³': 'å­', 'é…‰': 'å­', 'ä¸‘': 'å­',
      'äº¥': 'åˆ', 'å¯': 'åˆ', 'æœª': 'åˆ'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­ç™½è™
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºç™½è™
   */
  static isBaiHu(yearBranch: string, branch: string): boolean {
    // ç™½è™çš„è®¡ç®—è§„åˆ™ï¼šå¹´æ”¯åä¹ä½
    const map: {[key: string]: string} = {
      'å­': 'ç”³', 'ä¸‘': 'é…‰', 'å¯…': 'æˆŒ', 'å¯': 'äº¥',
      'è¾°': 'å­', 'å·³': 'ä¸‘', 'åˆ': 'å¯…', 'æœª': 'å¯',
      'ç”³': 'è¾°', 'é…‰': 'å·³', 'æˆŒ': 'åˆ', 'äº¥': 'æœª'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­å¤©ç‹—
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©ç‹—
   */
  static isTianGou(yearBranch: string, branch: string): boolean {
    // å¤©ç‹—çš„è®¡ç®—è§„åˆ™ï¼šå¹´æ”¯ååä½
    const map: {[key: string]: string} = {
      'å­': 'æˆŒ', 'ä¸‘': 'äº¥', 'å¯…': 'å­', 'å¯': 'ä¸‘',
      'è¾°': 'å¯…', 'å·³': 'å¯', 'åˆ': 'è¾°', 'æœª': 'å·³',
      'ç”³': 'åˆ', 'é…‰': 'æœª', 'æˆŒ': 'ç”³', 'äº¥': 'é…‰'
    };
    return map[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­ä¸‰å°
   * @param yearStem å¹´å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºä¸‰å°
   */
  static isSanTai(yearStem: string, branch: string): boolean {
    // ä¸‰å°çš„è®¡ç®—è§„åˆ™
    const map: {[key: string]: string} = {
      'ç”²': 'å¯…', 'ä¹™': 'å¯', 'ä¸™': 'å·³', 'ä¸': 'åˆ', 'æˆŠ': 'å·³',
      'å·±': 'åˆ', 'åºš': 'ç”³', 'è¾›': 'é…‰', 'å£¬': 'äº¥', 'ç™¸': 'å­'
    };
    return map[yearStem] === branch;
  }

  /**
   * åˆ¤æ–­å…«åº§
   * @param yearStem å¹´å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå…«åº§
   */
  static isBaZuo(yearStem: string, branch: string): boolean {
    // å…«åº§çš„è®¡ç®—è§„åˆ™
    const map: {[key: string]: string} = {
      'ç”²': 'ä¸‘', 'ä¹™': 'å¯…', 'ä¸™': 'è¾°', 'ä¸': 'å·³', 'æˆŠ': 'è¾°',
      'å·±': 'å·³', 'åºš': 'æœª', 'è¾›': 'ç”³', 'å£¬': 'æˆŒ', 'ç™¸': 'äº¥'
    };
    return map[yearStem] === branch;
  }

  /**
   * åˆ¤æ–­ä¸‰åˆ‘
   * @param branch1 åœ°æ”¯1
   * @param branch2 åœ°æ”¯2
   * @returns æ˜¯å¦ä¸ºä¸‰åˆ‘
   */
  static isSanXing(branch1: string, branch2: string): boolean {
    // ä¸‰åˆ‘çš„è®¡ç®—è§„åˆ™
    const xingGroups = [
      ['å¯…', 'å·³', 'ç”³'], // å¯…å·³ç”³ä¸‰åˆ‘
      ['ä¸‘', 'æˆŒ', 'æœª'], // ä¸‘æˆŒæœªä¸‰åˆ‘
      ['å­', 'å¯'],       // å­å¯ç›¸åˆ‘
      ['è¾°', 'åˆ', 'é…‰', 'äº¥'] // è¾°åˆé…‰äº¥è‡ªåˆ‘
    ];

    for (const group of xingGroups) {
      if (group.includes(branch1) && group.includes(branch2) && branch1 !== branch2) {
        return true;
      }
    }
    return false;
  }

  /**
   * åˆ¤æ–­å…­å†²
   * @param branch1 åœ°æ”¯1
   * @param branch2 åœ°æ”¯2
   * @returns æ˜¯å¦ä¸ºå…­å†²
   */
  static isLiuChong(branch1: string, branch2: string): boolean {
    // å…­å†²çš„è®¡ç®—è§„åˆ™
    const chongPairs: {[key: string]: string} = {
      'å­': 'åˆ', 'åˆ': 'å­',
      'ä¸‘': 'æœª', 'æœª': 'ä¸‘',
      'å¯…': 'ç”³', 'ç”³': 'å¯…',
      'å¯': 'é…‰', 'é…‰': 'å¯',
      'è¾°': 'æˆŒ', 'æˆŒ': 'è¾°',
      'å·³': 'äº¥', 'äº¥': 'å·³'
    };
    return chongPairs[branch1] === branch2;
  }

  /**
   * åˆ¤æ–­å…­åˆ
   * @param branch1 åœ°æ”¯1
   * @param branch2 åœ°æ”¯2
   * @returns æ˜¯å¦ä¸ºå…­åˆ
   */
  static isLiuHe(branch1: string, branch2: string): boolean {
    // å…­åˆçš„è®¡ç®—è§„åˆ™
    const hePairs: {[key: string]: string} = {
      'å­': 'ä¸‘', 'ä¸‘': 'å­',
      'å¯…': 'äº¥', 'äº¥': 'å¯…',
      'å¯': 'æˆŒ', 'æˆŒ': 'å¯',
      'è¾°': 'é…‰', 'é…‰': 'è¾°',
      'å·³': 'ç”³', 'ç”³': 'å·³',
      'åˆ': 'æœª', 'æœª': 'åˆ'
    };
    return hePairs[branch1] === branch2;
  }

  /**
   * åˆ¤æ–­ä¸‰åˆ
   * @param branches åœ°æ”¯æ•°ç»„
   * @returns æ˜¯å¦ä¸ºä¸‰åˆ
   */
  static isSanHe(branches: string[]): boolean {
    // ä¸‰åˆçš„è®¡ç®—è§„åˆ™
    const heGroups = [
      ['ç”³', 'å­', 'è¾°'], // ç”³å­è¾°ä¸‰åˆæ°´å±€
      ['å¯…', 'åˆ', 'æˆŒ'], // å¯…åˆæˆŒä¸‰åˆç«å±€
      ['å·³', 'é…‰', 'ä¸‘'], // å·³é…‰ä¸‘ä¸‰åˆé‡‘å±€
      ['äº¥', 'å¯', 'æœª']  // äº¥å¯æœªä¸‰åˆæœ¨å±€
    ];

    for (const group of heGroups) {
      if (group.every(branch => branches.includes(branch))) {
        return true;
      }
    }
    return false;
  }

  /**
   * åˆ¤æ–­å¤©èµ¦
   * @param season å­£èŠ‚
   * @param stem å¤©å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©èµ¦
   */
  static isTianShe(season: string, stem: string, branch: string): boolean {
    // å¤©èµ¦çš„è®¡ç®—è§„åˆ™ï¼šæ˜¥æˆŠå¯…ï¼Œå¤ç”²åˆï¼Œç§‹æˆŠç”³ï¼Œå†¬ç”²å­
    const map: {[key: string]: string} = {
      'æ˜¥': 'æˆŠå¯…',
      'å¤': 'ç”²åˆ',
      'ç§‹': 'æˆŠç”³',
      'å†¬': 'ç”²å­'
    };
    return map[season] === stem + branch;
  }

  /**
   * åˆ¤æ–­å¤©æ©
   * @param stem å¤©å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©æ©
   */
  static isTianEn(stem: string, branch: string): boolean {
    // å¤©æ©çš„è®¡ç®—è§„åˆ™
    const map: {[key: string]: string} = {
      'ç”²': 'ä¸‘', 'å·±': 'ä¸‘',
      'ä¹™': 'å¯…', 'åºš': 'å¯…',
      'ä¸™': 'å·³', 'è¾›': 'å·³',
      'ä¸': 'ç”³', 'å£¬': 'ç”³',
      'æˆŠ': 'äº¥', 'ç™¸': 'äº¥'
    };
    return map[stem] === branch;
  }

  /**
   * åˆ¤æ–­å¤©ç¦
   * @param stem å¤©å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤©ç¦
   */
  static isTianFu(stem: string, branch: string): boolean {
    // å¤©ç¦çš„è®¡ç®—è§„åˆ™
    const map: {[key: string]: string} = {
      'ç”²': 'äº¥', 'ä¹™': 'å­', 'ä¸™': 'å¯…', 'ä¸': 'å¯', 'æˆŠ': 'å·³',
      'å·±': 'åˆ', 'åºš': 'ç”³', 'è¾›': 'é…‰', 'å£¬': 'äº¥', 'ç™¸': 'å­'
    };
    return map[stem] === branch;
  }

  /**
   * åˆ¤æ–­å¤ªå²
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå¤ªå²
   */
  static isTaiSui(yearBranch: string, branch: string): boolean {
    // å¤ªå²çš„è®¡ç®—è§„åˆ™ï¼šä¸å¹´æ”¯ç›¸åŒå³ä¸ºå¤ªå²
    return yearBranch === branch;
  }

  /**
   * åˆ¤æ–­å²ç ´
   * @param yearBranch å¹´æ”¯
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå²ç ´
   */
  static isSuiPo(yearBranch: string, branch: string): boolean {
    // å²ç ´çš„è®¡ç®—è§„åˆ™ï¼šä¸å¹´æ”¯ç›¸å†²å³ä¸ºå²ç ´
    const chongPairs: {[key: string]: string} = {
      'å­': 'åˆ', 'åˆ': 'å­',
      'ä¸‘': 'æœª', 'æœª': 'ä¸‘',
      'å¯…': 'ç”³', 'ç”³': 'å¯…',
      'å¯': 'é…‰', 'é…‰': 'å¯',
      'è¾°': 'æˆŒ', 'æˆŒ': 'è¾°',
      'å·³': 'äº¥', 'äº¥': 'å·³'
    };
    return chongPairs[yearBranch] === branch;
  }

  /**
   * åˆ¤æ–­å¤©å¾·åˆ
   * @param monthBranch æœˆæ”¯
   * @param stem å¤©å¹²
   * @returns æ˜¯å¦ä¸ºå¤©å¾·åˆ
   */
  static isTianDeHe(monthBranch: string, stem: string): boolean {
    // å¤©å¾·åˆçš„è®¡ç®—è§„åˆ™ï¼šå¤©å¾·çš„åˆåŒ–
    // å…ˆæ‰¾åˆ°å¤©å¾·ï¼Œå†æ‰¾å…¶åˆåŒ–
    const monthToNumber: {[key: string]: number} = {
      'å¯…': 1, 'å¯': 2, 'è¾°': 3, 'å·³': 4, 'åˆ': 5, 'æœª': 6,
      'ç”³': 7, 'é…‰': 8, 'æˆŒ': 9, 'äº¥': 10, 'å­': 11, 'ä¸‘': 12
    };

    const tianDeMap: {[key: number]: string} = {
      1: 'ä¸', 2: 'ç”³', 3: 'å£¬', 4: 'è¾›', 5: 'äº¥', 6: 'ç”²',
      7: 'ç™¸', 8: 'å¯…', 9: 'ä¸™', 10: 'ä¹™', 11: 'å·³', 12: 'åºš'
    };

    // å¤©å¹²åˆåŒ–ï¼šç”²å·±åˆï¼Œä¹™åºšåˆï¼Œä¸™è¾›åˆï¼Œä¸å£¬åˆï¼ŒæˆŠç™¸åˆ
    const heHuaMap: {[key: string]: string} = {
      'ç”²': 'å·±', 'å·±': 'ç”²', 'ä¹™': 'åºš', 'åºš': 'ä¹™', 'ä¸™': 'è¾›',
      'è¾›': 'ä¸™', 'ä¸': 'å£¬', 'å£¬': 'ä¸', 'æˆŠ': 'ç™¸', 'ç™¸': 'æˆŠ'
    };

    const monthNumber = monthToNumber[monthBranch];
    if (!monthNumber) return false;

    const tianDe = tianDeMap[monthNumber];
    const tianDeHe = heHuaMap[tianDe];

    return tianDeHe === stem;
  }

  /**
   * åˆ¤æ–­æœˆå¾·åˆ
   * @param monthBranch æœˆæ”¯
   * @param stem å¤©å¹²
   * @returns æ˜¯å¦ä¸ºæœˆå¾·åˆ
   */
  static isYueDeHe(monthBranch: string, stem: string): boolean {
    // æœˆå¾·åˆçš„è®¡ç®—è§„åˆ™ï¼šæœˆå¾·çš„åˆåŒ–
    const monthToNumber: {[key: string]: number} = {
      'å¯…': 1, 'å¯': 2, 'è¾°': 3, 'å·³': 4, 'åˆ': 5, 'æœª': 6,
      'ç”³': 7, 'é…‰': 8, 'æˆŒ': 9, 'äº¥': 10, 'å­': 11, 'ä¸‘': 12
    };

    const yueDeMap: {[key: number]: string} = {
      1: 'ä¸™', 2: 'ç”²', 3: 'ä¸', 4: 'è¾›', 5: 'å·±', 6: 'ä¸',
      7: 'å£¬', 8: 'è¾›', 9: 'æˆŠ', 10: 'ä¹™', 11: 'å·±', 12: 'ä¸'
    };

    // å¤©å¹²åˆåŒ–ï¼šç”²å·±åˆï¼Œä¹™åºšåˆï¼Œä¸™è¾›åˆï¼Œä¸å£¬åˆï¼ŒæˆŠç™¸åˆ
    const heHuaMap: {[key: string]: string} = {
      'ç”²': 'å·±', 'å·±': 'ç”²', 'ä¹™': 'åºš', 'åºš': 'ä¹™', 'ä¸™': 'è¾›',
      'è¾›': 'ä¸™', 'ä¸': 'å£¬', 'å£¬': 'ä¸', 'æˆŠ': 'ç™¸', 'ç™¸': 'æˆŠ'
    };

    const monthNumber = monthToNumber[monthBranch];
    if (!monthNumber) return false;

    const yueDe = yueDeMap[monthNumber];
    const yueDeHe = heHuaMap[yueDe];

    return yueDeHe === stem;
  }

  /**
   * åˆ¤æ–­ç¦„é©¬åŒä¹¡
   * @param stem å¤©å¹²
   * @param branches å››æŸ±åœ°æ”¯æ•°ç»„
   * @returns æ˜¯å¦ä¸ºç¦„é©¬åŒä¹¡
   */
  static isLuMaTongXiang(stem: string, branches: string[]): boolean {
    // ç¦„é©¬åŒä¹¡ï¼šç¦„ç¥å’Œé©¿é©¬åœ¨åŒä¸€åœ°æ”¯
    // å…ˆæ‰¾åˆ°ç¦„ç¥
    const luShenMap: {[key: string]: string} = {
      'ç”²': 'å¯…', 'ä¹™': 'å¯', 'ä¸™': 'å·³', 'ä¸': 'åˆ', 'æˆŠ': 'å·³',
      'å·±': 'åˆ', 'åºš': 'ç”³', 'è¾›': 'é…‰', 'å£¬': 'äº¥', 'ç™¸': 'å­'
    };

    const luShen = luShenMap[stem];
    if (!luShen) return false;

    // æ£€æŸ¥æ˜¯å¦æœ‰é©¿é©¬åœ¨åŒä¸€åœ°æ”¯
    // é©¿é©¬è§„åˆ™ï¼šå¯…åˆæˆŒè§ç”³ï¼Œç”³å­è¾°è§å¯…ï¼Œå·³é…‰ä¸‘è§äº¥ï¼Œäº¥å¯æœªè§å·³
    const yiMaMap: {[key: string]: string} = {
      'å¯…': 'ç”³', 'åˆ': 'ç”³', 'æˆŒ': 'ç”³',
      'ç”³': 'å¯…', 'å­': 'å¯…', 'è¾°': 'å¯…',
      'å·³': 'äº¥', 'é…‰': 'äº¥', 'ä¸‘': 'äº¥',
      'äº¥': 'å·³', 'å¯': 'å·³', 'æœª': 'å·³'
    };

    // æ£€æŸ¥å››æŸ±ä¸­æ˜¯å¦æœ‰å¹´æ”¯èƒ½äº§ç”Ÿé©¿é©¬ï¼Œä¸”é©¿é©¬ä½ç½®ä¸ç¦„ç¥ç›¸åŒ
    for (const branch of branches) {
      const yiMa = yiMaMap[branch];
      if (yiMa === luShen && branches.includes(luShen)) {
        return true;
      }
    }

    return false;
  }

  /**
   * åˆ¤æ–­ç¦å¾·ç§€æ°”
   * @param dayStem æ—¥å¹²
   * @param dayBranch æ—¥æ”¯
   * @param monthBranch æœˆæ”¯
   * @returns æ˜¯å¦ä¸ºç¦å¾·ç§€æ°”
   */
  static isFuDeXiuQi(dayStem: string, dayBranch: string, monthBranch: string): boolean {
    // ç¦å¾·ç§€æ°”ï¼šæ—¥å¹²å¾—æœˆä»¤ç”Ÿæ‰¶ï¼Œä¸”åä¸‹æœ‰å¾·ç¥
    // å…ˆæ£€æŸ¥æ—¥å¹²æ˜¯å¦å¾—æœˆä»¤ç”Ÿæ‰¶
    const wuXingMap: {[key: string]: string} = {
      'ç”²': 'æœ¨', 'ä¹™': 'æœ¨', 'ä¸™': 'ç«', 'ä¸': 'ç«', 'æˆŠ': 'åœŸ',
      'å·±': 'åœŸ', 'åºš': 'é‡‘', 'è¾›': 'é‡‘', 'å£¬': 'æ°´', 'ç™¸': 'æ°´'
    };

    const branchWuXingMap: {[key: string]: string} = {
      'å¯…': 'æœ¨', 'å¯': 'æœ¨', 'å·³': 'ç«', 'åˆ': 'ç«', 'è¾°': 'åœŸ',
      'æˆŒ': 'åœŸ', 'ä¸‘': 'åœŸ', 'æœª': 'åœŸ', 'ç”³': 'é‡‘', 'é…‰': 'é‡‘',
      'äº¥': 'æ°´', 'å­': 'æ°´'
    };

    const dayWuXing = wuXingMap[dayStem];
    const monthWuXing = branchWuXingMap[monthBranch];

    // æ£€æŸ¥æ˜¯å¦å¾—æœˆä»¤ç”Ÿæ‰¶ï¼ˆåŒç±»æˆ–ç”Ÿæˆ‘ï¼‰
    const shengKeMap: {[key: string]: string[]} = {
      'æœ¨': ['æ°´', 'æœ¨'], // æ°´ç”Ÿæœ¨ï¼Œæœ¨åŠ©æœ¨
      'ç«': ['æœ¨', 'ç«'], // æœ¨ç”Ÿç«ï¼Œç«åŠ©ç«
      'åœŸ': ['ç«', 'åœŸ'], // ç«ç”ŸåœŸï¼ŒåœŸåŠ©åœŸ
      'é‡‘': ['åœŸ', 'é‡‘'], // åœŸç”Ÿé‡‘ï¼Œé‡‘åŠ©é‡‘
      'æ°´': ['é‡‘', 'æ°´']  // é‡‘ç”Ÿæ°´ï¼Œæ°´åŠ©æ°´
    };

    const isSupported = shengKeMap[dayWuXing]?.includes(monthWuXing);
    if (!isSupported) return false;

    // æ£€æŸ¥æ—¥æ”¯æ˜¯å¦æœ‰å¾·ç¥ï¼ˆç®€åŒ–ä¸ºæ£€æŸ¥æ˜¯å¦ä¸ºè´µäººåœ°æ”¯ï¼‰
    const guiRenBranches = ['ä¸‘', 'æœª', 'å­', 'ç”³', 'äº¥', 'é…‰', 'å·³', 'å¯', 'åˆ', 'å¯…'];
    const hasDeShen = guiRenBranches.includes(dayBranch);

    return hasDeShen;
  }

  /**
   * åˆ¤æ–­å­¦å ‚
   * @param dayStem æ—¥å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºå­¦å ‚
   */
  static isXueTang(dayStem: string, branch: string): boolean {
    // å­¦å ‚çš„è®¡ç®—è§„åˆ™ï¼šç”²è§å·³ï¼Œä¹™è§åˆï¼Œä¸™è§ç”³ï¼Œä¸è§é…‰ï¼ŒæˆŠè§ç”³ï¼Œå·±è§é…‰ï¼Œåºšè§äº¥ï¼Œè¾›è§å­ï¼Œå£¬è§å¯…ï¼Œç™¸è§å¯
    const xueTangMap: {[key: string]: string} = {
      'ç”²': 'å·³', 'ä¹™': 'åˆ', 'ä¸™': 'ç”³', 'ä¸': 'é…‰', 'æˆŠ': 'ç”³',
      'å·±': 'é…‰', 'åºš': 'äº¥', 'è¾›': 'å­', 'å£¬': 'å¯…', 'ç™¸': 'å¯'
    };

    return xueTangMap[dayStem] === branch;
  }

  /**
   * åˆ¤æ–­è¯é¦†
   * @param dayStem æ—¥å¹²
   * @param branch åœ°æ”¯
   * @returns æ˜¯å¦ä¸ºè¯é¦†
   */
  static isCiGuan(dayStem: string, branch: string): boolean {
    // è¯é¦†çš„è®¡ç®—è§„åˆ™ï¼šç”²è§åˆï¼Œä¹™è§å·³ï¼Œä¸™è§é…‰ï¼Œä¸è§ç”³ï¼ŒæˆŠè§é…‰ï¼Œå·±è§ç”³ï¼Œåºšè§å­ï¼Œè¾›è§äº¥ï¼Œå£¬è§å¯ï¼Œç™¸è§å¯…
    const ciGuanMap: {[key: string]: string} = {
      'ç”²': 'åˆ', 'ä¹™': 'å·³', 'ä¸™': 'é…‰', 'ä¸': 'ç”³', 'æˆŠ': 'é…‰',
      'å·±': 'ç”³', 'åºš': 'å­', 'è¾›': 'äº¥', 'å£¬': 'å¯', 'ç™¸': 'å¯…'
    };

    return ciGuanMap[dayStem] === branch;
  }

  /**
   * åˆ¤æ–­è´¢å¯Œé€šé—¨æˆ·
   * @param dayStem æ—¥å¹²
   * @param branches å››æŸ±åœ°æ”¯æ•°ç»„
   * @param stems å››æŸ±å¤©å¹²æ•°ç»„
   * @returns æ˜¯å¦ä¸ºè´¢å¯Œé€šé—¨æˆ·
   */
  static isCaiFuTongMenHu(dayStem: string, branches: string[], stems: string[]): boolean {
    // è´¢å¯Œé€šé—¨æˆ·ï¼šè´¢æ˜Ÿé€šæ ¹ä¸”æœ‰é—¨æˆ·æ˜Ÿç›¸åŠ©
    // 1. å…ˆæ‰¾åˆ°è´¢æ˜Ÿï¼ˆæ—¥å¹²æ‰€å…‹çš„äº”è¡Œï¼‰
    const wuXingMap: {[key: string]: string} = {
      'ç”²': 'æœ¨', 'ä¹™': 'æœ¨', 'ä¸™': 'ç«', 'ä¸': 'ç«', 'æˆŠ': 'åœŸ',
      'å·±': 'åœŸ', 'åºš': 'é‡‘', 'è¾›': 'é‡‘', 'å£¬': 'æ°´', 'ç™¸': 'æ°´'
    };

    const keMap: {[key: string]: string} = {
      'æœ¨': 'åœŸ', 'ç«': 'é‡‘', 'åœŸ': 'æ°´', 'é‡‘': 'æœ¨', 'æ°´': 'ç«'
    };

    const dayWuXing = wuXingMap[dayStem];
    const caiXingWuXing = keMap[dayWuXing]; // è´¢æ˜Ÿäº”è¡Œ

    // 2. æ‰¾åˆ°è´¢æ˜Ÿå¯¹åº”çš„å¤©å¹²
    const caiXingGans: string[] = [];
    Object.entries(wuXingMap).forEach(([gan, wuxing]) => {
      if (wuxing === caiXingWuXing) {
        caiXingGans.push(gan);
      }
    });

    // 3. æ£€æŸ¥å››æŸ±ä¸­æ˜¯å¦æœ‰è´¢æ˜Ÿ
    const hasCaiXing = stems.some(stem => caiXingGans.includes(stem));
    if (!hasCaiXing) return false;

    // 4. æ£€æŸ¥è´¢æ˜Ÿæ˜¯å¦é€šæ ¹ï¼ˆåœ¨åœ°æ”¯ä¸­æœ‰æ ¹ï¼‰
    const branchWuXingMap: {[key: string]: string} = {
      'å¯…': 'æœ¨', 'å¯': 'æœ¨', 'å·³': 'ç«', 'åˆ': 'ç«', 'è¾°': 'åœŸ',
      'æˆŒ': 'åœŸ', 'ä¸‘': 'åœŸ', 'æœª': 'åœŸ', 'ç”³': 'é‡‘', 'é…‰': 'é‡‘',
      'äº¥': 'æ°´', 'å­': 'æ°´'
    };

    const hasCaiXingRoot = branches.some(branch => branchWuXingMap[branch] === caiXingWuXing);
    if (!hasCaiXingRoot) return false;

    // 5. æ£€æŸ¥æ˜¯å¦æœ‰é—¨æˆ·æ˜Ÿï¼ˆé©¿é©¬ã€å¤©ä¹™è´µäººã€ç¦„ç¥ç­‰ï¼‰
    // é©¿é©¬
    const yiMaMap: {[key: string]: string} = {
      'å¯…': 'ç”³', 'åˆ': 'ç”³', 'æˆŒ': 'ç”³',
      'ç”³': 'å¯…', 'å­': 'å¯…', 'è¾°': 'å¯…',
      'å·³': 'äº¥', 'é…‰': 'äº¥', 'ä¸‘': 'äº¥',
      'äº¥': 'å·³', 'å¯': 'å·³', 'æœª': 'å·³'
    };

    const hasYiMa = branches.some(yearBranch => {
      const yiMa = yiMaMap[yearBranch];
      return yiMa && branches.includes(yiMa);
    });

    // å¤©ä¹™è´µäºº
    const tianYiMap: {[key: string]: string[]} = {
      'ç”²': ['ä¸‘', 'æœª'], 'ä¹™': ['å­', 'ç”³'], 'ä¸™': ['äº¥', 'é…‰'], 'ä¸': ['äº¥', 'é…‰'],
      'æˆŠ': ['ä¸‘', 'æœª'], 'å·±': ['å­', 'ç”³'], 'åºš': ['ä¸‘', 'æœª'], 'è¾›': ['åˆ', 'å¯…'],
      'å£¬': ['å¯', 'å·³'], 'ç™¸': ['å¯', 'å·³']
    };

    const hasTianYi = stems.some(stem => {
      const tianYiBranches = tianYiMap[stem];
      return tianYiBranches && tianYiBranches.some(branch => branches.includes(branch));
    });

    // ç¦„ç¥
    const luShenMap: {[key: string]: string} = {
      'ç”²': 'å¯…', 'ä¹™': 'å¯', 'ä¸™': 'å·³', 'ä¸': 'åˆ', 'æˆŠ': 'å·³',
      'å·±': 'åˆ', 'åºš': 'ç”³', 'è¾›': 'é…‰', 'å£¬': 'äº¥', 'ç™¸': 'å­'
    };

    const hasLuShen = stems.some(stem => {
      const luShen = luShenMap[stem];
      return luShen && branches.includes(luShen);
    });

    // æœ‰é—¨æˆ·æ˜Ÿä¹‹ä¸€å³å¯
    const hasMenHu = hasYiMa || hasTianYi || hasLuShen;

    return hasMenHu;
  }

  /**
   * è¾…åŠ©æ–¹æ³•ï¼šåˆ¤æ–­æ•°ç»„æ˜¯å¦ç›¸ç­‰
   */
  private static arrayEquals(a: string[], b: string[]): boolean {
    return a.length === b.length && a.every((val, index) => val === b[index]);
  }

  /**
   * è·å–æ‰€æœ‰åŸºç¡€ç¥ç…ç®—æ³•åˆ—è¡¨
   * @returns ç®—æ³•æ–¹æ³•æ˜ å°„
   */
  static getAllAlgorithms(): {[key: string]: Function} {
    return {
      'å¤©ä¹™è´µäºº': ShenShaAlgorithms.isTianYiGuiRen,
      'ç¦„ç¥': ShenShaAlgorithms.isLuShen,
      'ç¾Šåˆƒ': ShenShaAlgorithms.isYangRen,
      'æ¡ƒèŠ±': ShenShaAlgorithms.isTaoHua,
      'åç›–': ShenShaAlgorithms.isHuaGai,
      'æ–‡æ˜Œ': ShenShaAlgorithms.isWenChang,
      'å°†æ˜Ÿ': ShenShaAlgorithms.isJiangXing,
      'é©¿é©¬': ShenShaAlgorithms.isYiMa,
      'å¤©å¾·': ShenShaAlgorithms.isTianDe,
      'æœˆå¾·': ShenShaAlgorithms.isYueDe,
      'å¤©åŒ»': ShenShaAlgorithms.isTianYi,
      'åŠ«ç…': ShenShaAlgorithms.isJieSha,
      'ç¾ç…': ShenShaAlgorithms.isZaiSha,
      'å¤©åˆ‘': ShenShaAlgorithms.isTianXing,
      'å­¤è¾°': ShenShaAlgorithms.isGuChen,
      'å¯¡å®¿': ShenShaAlgorithms.isGuaSu,
      'é­ç½¡': ShenShaAlgorithms.isKuiGang,
      'é˜´å·®é˜³é”™': ShenShaAlgorithms.isYinChaYangCuo,
      // 'ç©ºäº¡': ShenShaAlgorithms.isKongWang, // å¤‡æ³¨ï¼šä½¿ç”¨æ›´ç»†è‡´çš„åˆ†ç±»ç©ºäº¡
      'å¹´ç©ºäº¡': ShenShaAlgorithms.isNianKongWang,
      'æœˆç©ºäº¡': ShenShaAlgorithms.isYueKongWang,
      'æ—¥ç©ºäº¡': ShenShaAlgorithms.isRiKongWang,
      'æ—¶ç©ºäº¡': ShenShaAlgorithms.isShiKongWang,
      'å‘½å®«ç©ºäº¡': ShenShaAlgorithms.isMingGongKongWang,
      'èº«å®«ç©ºäº¡': ShenShaAlgorithms.isShenGongKongWang,
      'èƒå…ƒç©ºäº¡': ShenShaAlgorithms.isTaiYuanKongWang,
      'å¤ªæè´µäºº': ShenShaAlgorithms.isTaiJiGuiRen,
      'é‡‘èˆ†': ShenShaAlgorithms.isJinYu,
      'å›½å°è´µäºº': ShenShaAlgorithms.isGuoYinGuiRen,
      'ä¸‰å¥‡è´µäºº': ShenShaAlgorithms.isSanQiGuiRen,
      'ç¦æ˜Ÿè´µäºº': ShenShaAlgorithms.isFuXingGuiRen,
      'æ–‡æ›²': ShenShaAlgorithms.isWenQu,
      'å¤©å–œ': ShenShaAlgorithms.isTianXi,
      'çº¢é¸¾': ShenShaAlgorithms.isHongLuan,
      'çº¢è‰³': ShenShaAlgorithms.isHongYan,
      'å¤©å§š': ShenShaAlgorithms.isTianYao,
      'å­¦å ‚è¯é¦†': ShenShaAlgorithms.isXueTangCiGuan,
      'å¾·ç§€è´µäºº': ShenShaAlgorithms.isDeXiuGuiRen,
      'åæ¶å¤§è´¥': ShenShaAlgorithms.isShiEDaBai,
      'å­¤é¸¾ç…': ShenShaAlgorithms.isGuLuanSha,
      'å››åºŸ': ShenShaAlgorithms.isSiFei,
      'å¤©ç½—åœ°ç½‘': ShenShaAlgorithms.isTianLuoDiWang,
      'äº¡ç¥': ShenShaAlgorithms.isWangShen,
      'æŠ«éº»': ShenShaAlgorithms.isPiMa,
      'åŠå®¢': ShenShaAlgorithms.isDiaoKe,
      'ä¸§é—¨': ShenShaAlgorithms.isSangMen,
      'å…ƒè¾°': ShenShaAlgorithms.isYuanChen,
      'å¤©å¾·åˆ': ShenShaAlgorithms.isTianDeHe,
      'å¤©ç©º': ShenShaAlgorithms.isTianKong,
      'åœ°åŠ«': ShenShaAlgorithms.isDiJie,
      'å¤©å“­': ShenShaAlgorithms.isTianKu,
      'å¤©è™š': ShenShaAlgorithms.isTianXu,
      'å’¸æ± ': ShenShaAlgorithms.isXianChi,
      'è§£ç¥': ShenShaAlgorithms.isJieShen,
      'é‡‘ç¥': ShenShaAlgorithms.isJinShen,
      'æ—¥å¾·': ShenShaAlgorithms.isRiDe,
      'äº”é¬¼': ShenShaAlgorithms.isWuGui,
      'ç™½è™': ShenShaAlgorithms.isBaiHu,
      'å¤©ç‹—': ShenShaAlgorithms.isTianGou,
      'ä¸‰å°': ShenShaAlgorithms.isSanTai,
      'å…«åº§': ShenShaAlgorithms.isBaZuo,
      'å¤©èµ¦': ShenShaAlgorithms.isTianShe,
      'å¤©æ©': ShenShaAlgorithms.isTianEn,
      'å¤©ç¦': ShenShaAlgorithms.isTianFu,
      'å¤ªå²': ShenShaAlgorithms.isTaiSui,
      'å²ç ´': ShenShaAlgorithms.isSuiPo,
      'æœˆå¾·åˆ': ShenShaAlgorithms.isYueDeHe,
      'ç¦„é©¬åŒä¹¡': ShenShaAlgorithms.isLuMaTongXiang,
      'ç¦å¾·ç§€æ°”': ShenShaAlgorithms.isFuDeXiuQi,
      'å­¦å ‚': ShenShaAlgorithms.isXueTang,
      'è¯é¦†': ShenShaAlgorithms.isCiGuan,
      'è´¢å¯Œé€šé—¨æˆ·': ShenShaAlgorithms.isCaiFuTongMenHu
    };
  }
}
