/**
 * 五行服务类
 * 提供五行强度和日主旺衰的详细解释
 */
export class WuXingService {
  /**
   * 获取五行的详细信息
   * @param wuXing 五行名称
   * @returns 五行的详细信息
   */
  public static getWuXingInfo(wuXing: string): { name: string; explanation: string; influence: string; calculation: string } | null {
    const explanations: { [key: string]: { name: string; explanation: string; influence: string; calculation: string } } = {
      '金': {
        name: '金',
        explanation: '金五行代表坚强、刚毅、决断力。金过强则过于刚硬，金过弱则缺乏决断力。',
        influence: '金五行强的人，性格刚毅，有决断力，做事果断，但可能过于固执；金五行弱的人，缺乏决断力，优柔寡断，但为人温和。',
        calculation: `金五行强度实际计算过程：

【天干五行】
- 年干庚、辛为金，得分1.2（年干权重）
- 月干庚、辛为金，得分3.0（月干权重，提高以强调月令重要性）
- 日干庚、辛为金，得分3.0（日干权重，日主最重要）
- 时干庚、辛为金，得分1.0（时干权重）

【地支藏干】
- 年支藏庚、辛为金，得分根据藏干数量和权重计算
- 月支藏庚、辛为金，得分根据藏干数量和权重计算
- 日支藏庚、辛为金，得分根据藏干数量和权重计算
- 时支藏庚、辛为金，得分根据藏干数量和权重计算

【纳音五行】
- 年柱纳音为金，得分0.6（年柱纳音权重）
- 月柱纳音为金，得分2.0（月柱纳音权重，提高以强调月令重要性）
- 日柱纳音为金，得分1.5（日柱纳音权重）
- 时柱纳音为金，得分0.5（时柱纳音权重）

【季节调整】
- 秋季（农历七、八、九月）金旺，得分+2.5（旺相系数，提高以强化季节影响）
- 冬季（农历十、十一、十二月）金相，得分+1.2（相旺系数，提高以强化季节影响）
- 春季（农历正、二、三月）金囚，得分-1.2（囚系数，增强以强化季节影响）
- 夏季（农历四、五、六月）金死，得分-1.8（死系数，增强以强化季节影响）

【月令当令加成】
- 秋季金当令，得分+2.0（当令加成，提高以强调月令重要性）
- 冬季金相旺，得分+1.0（相旺加成，提高以强调月令重要性）
- 春季金囚，得分-0.5（囚加成，新增负面调整）
- 夏季金死，得分-0.8（死加成，新增负面调整）

【组合调整】
- 天干五合：乙庚合化金，得分+0.8（天干五合权重，提高以增强组合影响）
- 地支三合：巳酉丑三合金局（完整），得分+1.5（地支三合权重，提高以增强组合影响）
- 地支三合：巳酉丑三合金局（部分），得分+0.9（部分三合权重，新增区分完整度）
- 地支三会：申酉戌三会金局（完整），得分+1.2（地支三会权重，提高以增强组合影响）
- 地支三会：申酉戌三会金局（部分），得分+0.7（部分三会权重，新增区分完整度）

【权重分配说明】
- 天干权重：年干(1.2) < 月干(3.0) = 日干(3.0) > 时干(1.0)，突出月令和日主重要性
- 地支藏干权重：年支(0.8) < 月支(2.5) > 日支(2.2) > 时支(0.7)，突出月令重要性
- 纳音五行权重：年柱(0.6) < 月柱(2.0) > 日柱(1.5) > 时柱(0.5)，突出月令重要性
- 季节调整：旺(+2.5)、相(+1.2)、平(0)、囚(-1.2)、死(-1.8)，强化季节影响
- 月令加成：当令(+2.0)、相旺(+1.0)、平和(0)、囚(-0.5)、死(-0.8)，全面考虑月令影响
- 组合关系：天干五合(+0.8)、地支三合(+1.5/+0.9)、地支三会(+1.2/+0.7)，区分完整度`
      },
      '木': {
        name: '木',
        explanation: '木五行代表生长、创造、进取心。木过强则固执，木过弱则缺乏进取心。',
        influence: '木五行强的人，有进取心，创造力强，但可能过于固执；木五行弱的人，缺乏进取心，随遇而安，但为人随和。',
        calculation: `木五行强度实际计算过程：

【天干五行】
- 年干甲、乙为木，得分1.2（年干权重）
- 月干甲、乙为木，得分3.0（月干权重，提高以强调月令重要性）
- 日干甲、乙为木，得分3.0（日干权重，日主最重要）
- 时干甲、乙为木，得分1.0（时干权重）

【地支藏干】
- 年支藏甲、乙为木，得分根据藏干数量和权重计算
- 月支藏甲、乙为木，得分根据藏干数量和权重计算
- 日支藏甲、乙为木，得分根据藏干数量和权重计算
- 时支藏甲、乙为木，得分根据藏干数量和权重计算

【纳音五行】
- 年柱纳音为木，得分0.6（年柱纳音权重）
- 月柱纳音为木，得分2.0（月柱纳音权重，提高以强调月令重要性）
- 日柱纳音为木，得分1.5（日柱纳音权重）
- 时柱纳音为木，得分0.5（时柱纳音权重）

【季节调整】
- 春季（农历正、二、三月）木旺，得分+2.5（旺相系数，提高以强化季节影响）
- 冬季（农历十、十一、十二月）木相，得分+1.2（相旺系数，提高以强化季节影响）
- 秋季（农历七、八、九月）木囚，得分-1.2（囚系数，增强以强化季节影响）
- 夏季（农历四、五、六月）木死，得分-1.8（死系数，增强以强化季节影响）

【月令当令加成】
- 春季木当令，得分+2.0（当令加成，提高以强调月令重要性）
- 冬季木相旺，得分+1.0（相旺加成，提高以强调月令重要性）
- 秋季木囚，得分-0.5（囚加成，新增负面调整）
- 夏季木死，得分-0.8（死加成，新增负面调整）

【组合调整】
- 天干五合：丁壬合化木，得分+0.8（天干五合权重，提高以增强组合影响）
- 地支三合：亥卯未三合木局（完整），得分+1.5（地支三合权重，提高以增强组合影响）
- 地支三合：亥卯未三合木局（部分），得分+0.9（部分三合权重，新增区分完整度）
- 地支三会：寅卯辰三会木局（完整），得分+1.2（地支三会权重，提高以增强组合影响）
- 地支三会：寅卯辰三会木局（部分），得分+0.7（部分三会权重，新增区分完整度）

【权重分配说明】
- 天干权重：年干(1.2) < 月干(3.0) = 日干(3.0) > 时干(1.0)，突出月令和日主重要性
- 地支藏干权重：年支(0.8) < 月支(2.5) > 日支(2.2) > 时支(0.7)，突出月令重要性
- 纳音五行权重：年柱(0.6) < 月柱(2.0) > 日柱(1.5) > 时柱(0.5)，突出月令重要性
- 季节调整：旺(+2.5)、相(+1.2)、平(0)、囚(-1.2)、死(-1.8)，强化季节影响
- 月令加成：当令(+2.0)、相旺(+1.0)、平和(0)、囚(-0.5)、死(-0.8)，全面考虑月令影响
- 组合关系：天干五合(+0.8)、地支三合(+1.5/+0.9)、地支三会(+1.2/+0.7)，区分完整度`
      },
      '水': {
        name: '水',
        explanation: '水五行代表智慧、沟通、适应力。水过强则多虑，水过弱则缺乏智慧。',
        influence: '水五行强的人，聪明智慧，善于沟通，适应力强，但可能过于多虑；水五行弱的人，缺乏智慧，沟通能力差，但为人踏实。',
        calculation: `水五行强度实际计算过程：

【天干五行】
- 年干壬、癸为水，得分1.2（年干权重）
- 月干壬、癸为水，得分3.0（月干权重，提高以强调月令重要性）
- 日干壬、癸为水，得分3.0（日干权重，日主最重要）
- 时干壬、癸为水，得分1.0（时干权重）

【地支藏干】
- 年支藏壬、癸为水，得分根据藏干数量和权重计算
- 月支藏壬、癸为水，得分根据藏干数量和权重计算
- 日支藏壬、癸为水，得分根据藏干数量和权重计算
- 时支藏壬、癸为水，得分根据藏干数量和权重计算

【纳音五行】
- 年柱纳音为水，得分0.6（年柱纳音权重）
- 月柱纳音为水，得分2.0（月柱纳音权重，提高以强调月令重要性）
- 日柱纳音为水，得分1.5（日柱纳音权重）
- 时柱纳音为水，得分0.5（时柱纳音权重）

【季节调整】
- 冬季（农历十、十一、十二月）水旺，得分+2.5（旺相系数，提高以强化季节影响）
- 秋季（农历七、八、九月）水相，得分+1.2（相旺系数，提高以强化季节影响）
- 春季（农历正、二、三月）水囚，得分-1.2（囚系数，增强以强化季节影响）
- 夏季（农历四、五、六月）水死，得分-1.8（死系数，增强以强化季节影响）

【月令当令加成】
- 冬季水当令，得分+2.0（当令加成，提高以强调月令重要性）
- 秋季水相旺，得分+1.0（相旺加成，提高以强调月令重要性）
- 春季水囚，得分-0.5（囚加成，新增负面调整）
- 夏季水死，得分-0.8（死加成，新增负面调整）

【组合调整】
- 天干五合：丙辛合化水，得分+0.8（天干五合权重，提高以增强组合影响）
- 地支三合：申子辰三合水局（完整），得分+1.5（地支三合权重，提高以增强组合影响）
- 地支三合：申子辰三合水局（部分），得分+0.9（部分三合权重，新增区分完整度）
- 地支三会：亥子丑三会水局（完整），得分+1.2（地支三会权重，提高以增强组合影响）
- 地支三会：亥子丑三会水局（部分），得分+0.7（部分三会权重，新增区分完整度）

【权重分配说明】
- 天干权重：年干(1.2) < 月干(3.0) = 日干(3.0) > 时干(1.0)，突出月令和日主重要性
- 地支藏干权重：年支(0.8) < 月支(2.5) > 日支(2.2) > 时支(0.7)，突出月令重要性
- 纳音五行权重：年柱(0.6) < 月柱(2.0) > 日柱(1.5) > 时柱(0.5)，突出月令重要性
- 季节调整：旺(+2.5)、相(+1.2)、平(0)、囚(-1.2)、死(-1.8)，强化季节影响
- 月令加成：当令(+2.0)、相旺(+1.0)、平和(0)、囚(-0.5)、死(-0.8)，全面考虑月令影响
- 组合关系：天干五合(+0.8)、地支三合(+1.5/+0.9)、地支三会(+1.2/+0.7)，区分完整度`
      },
      '火': {
        name: '火',
        explanation: '火五行代表热情、活力、表现力。火过强则浮躁，火过弱则缺乏热情。',
        influence: '火五行强的人，热情活力，表现力强，但可能过于浮躁；火五行弱的人，缺乏热情，表现力差，但为人稳重。',
        calculation: `火五行强度实际计算过程：

【天干五行】
- 年干丙、丁为火，得分1.2（年干权重）
- 月干丙、丁为火，得分3.0（月干权重，提高以强调月令重要性）
- 日干丙、丁为火，得分3.0（日干权重，日主最重要）
- 时干丙、丁为火，得分1.0（时干权重）

【地支藏干】
- 年支藏丙、丁为火，得分根据藏干数量和权重计算
- 月支藏丙、丁为火，得分根据藏干数量和权重计算
- 日支藏丙、丁为火，得分根据藏干数量和权重计算
- 时支藏丙、丁为火，得分根据藏干数量和权重计算

【纳音五行】
- 年柱纳音为火，得分0.6（年柱纳音权重）
- 月柱纳音为火，得分2.0（月柱纳音权重，提高以强调月令重要性）
- 日柱纳音为火，得分1.5（日柱纳音权重）
- 时柱纳音为火，得分0.5（时柱纳音权重）

【季节调整】
- 夏季（农历四、五、六月）火旺，得分+2.5（旺相系数，提高以强化季节影响）
- 春季（农历正、二、三月）火相，得分+1.2（相旺系数，提高以强化季节影响）
- 秋季（农历七、八、九月）火囚，得分-1.2（囚系数，增强以强化季节影响）
- 冬季（农历十、十一、十二月）火死，得分-1.8（死系数，增强以强化季节影响）

【月令当令加成】
- 夏季火当令，得分+2.0（当令加成，提高以强调月令重要性）
- 春季火相旺，得分+1.0（相旺加成，提高以强调月令重要性）
- 秋季火囚，得分-0.5（囚加成，新增负面调整）
- 冬季火死，得分-0.8（死加成，新增负面调整）

【组合调整】
- 天干五合：戊癸合化火，得分+0.8（天干五合权重，提高以增强组合影响）
- 地支三合：寅午戌三合火局（完整），得分+1.5（地支三合权重，提高以增强组合影响）
- 地支三合：寅午戌三合火局（部分），得分+0.9（部分三合权重，新增区分完整度）
- 地支三会：巳午未三会火局（完整），得分+1.2（地支三会权重，提高以增强组合影响）
- 地支三会：巳午未三会火局（部分），得分+0.7（部分三会权重，新增区分完整度）

【权重分配说明】
- 天干权重：年干(1.2) < 月干(3.0) = 日干(3.0) > 时干(1.0)，突出月令和日主重要性
- 地支藏干权重：年支(0.8) < 月支(2.5) > 日支(2.2) > 时支(0.7)，突出月令重要性
- 纳音五行权重：年柱(0.6) < 月柱(2.0) > 日柱(1.5) > 时柱(0.5)，突出月令重要性
- 季节调整：旺(+2.5)、相(+1.2)、平(0)、囚(-1.2)、死(-1.8)，强化季节影响
- 月令加成：当令(+2.0)、相旺(+1.0)、平和(0)、囚(-0.5)、死(-0.8)，全面考虑月令影响
- 组合关系：天干五合(+0.8)、地支三合(+1.5/+0.9)、地支三会(+1.2/+0.7)，区分完整度`
      },
      '土': {
        name: '土',
        explanation: '土五行代表稳重、踏实、包容力。土过强则保守，土过弱则缺乏稳定性。',
        influence: '土五行强的人，稳重踏实，包容力强，但可能过于保守；土五行弱的人，缺乏稳定性，做事不踏实，但为人灵活。',
        calculation: `土五行强度实际计算过程：

【天干五行】
- 年干戊、己为土，得分1.2（年干权重）
- 月干戊、己为土，得分3.0（月干权重，提高以强调月令重要性）
- 日干戊、己为土，得分3.0（日干权重，日主最重要）
- 时干戊、己为土，得分1.0（时干权重）

【地支藏干】
- 年支藏戊、己为土，得分根据藏干数量和权重计算
- 月支藏戊、己为土，得分根据藏干数量和权重计算
- 日支藏戊、己为土，得分根据藏干数量和权重计算
- 时支藏戊、己为土，得分根据藏干数量和权重计算

【纳音五行】
- 年柱纳音为土，得分0.6（年柱纳音权重）
- 月柱纳音为土，得分2.0（月柱纳音权重，提高以强调月令重要性）
- 日柱纳音为土，得分1.5（日柱纳音权重）
- 时柱纳音为土，得分0.5（时柱纳音权重）

【季节调整】
- 四季末月（农历三、六、九、十二月）土旺，得分+2.5（旺相系数，提高以强化季节影响）
- 夏季（农历四、五、六月）土相，得分+1.2（相旺系数，提高以强化季节影响）
- 冬季（农历十、十一、十二月）土囚，得分-1.2（囚系数，增强以强化季节影响）
- 秋季（农历七、八、九月）土死，得分-1.8（死系数，增强以强化季节影响）

【月令当令加成】
- 四季末月土当令，得分+2.0（当令加成，提高以强调月令重要性）
- 夏季土相旺，得分+1.0（相旺加成，提高以强调月令重要性）
- 冬季土囚，得分-0.5（囚加成，新增负面调整）
- 秋季土死，得分-0.8（死加成，新增负面调整）

【组合调整】
- 天干五合：甲己合化土，得分+0.8（天干五合权重，提高以增强组合影响）
- 地支三合：辰戌丑三合土局（完整），得分+1.5（地支三合权重，提高以增强组合影响）
- 地支三合：辰戌丑三合土局（部分），得分+0.9（部分三合权重，新增区分完整度）
- 地支三会：辰巳午三会土局（完整），得分+1.2（地支三会权重，提高以增强组合影响）
- 地支三会：辰巳午三会土局（部分），得分+0.7（部分三会权重，新增区分完整度）

【权重分配说明】
- 天干权重：年干(1.2) < 月干(3.0) = 日干(3.0) > 时干(1.0)，突出月令和日主重要性
- 地支藏干权重：年支(0.8) < 月支(2.5) > 日支(2.2) > 时支(0.7)，突出月令重要性
- 纳音五行权重：年柱(0.6) < 月柱(2.0) > 日柱(1.5) > 时柱(0.5)，突出月令重要性
- 季节调整：旺(+2.5)、相(+1.2)、平(0)、囚(-1.2)、死(-1.8)，强化季节影响
- 月令加成：当令(+2.0)、相旺(+1.0)、平和(0)、囚(-0.5)、死(-0.8)，全面考虑月令影响
- 组合关系：天干五合(+0.8)、地支三合(+1.5/+0.9)、地支三会(+1.2/+0.7)，区分完整度`
      }
    };

    return explanations[wuXing] || null;
  }

  /**
   * 获取日主旺衰的详细信息
   * @param riZhu 日主旺衰状态
   * @returns 日主旺衰的详细信息
   */
  public static getRiZhuInfo(riZhu: string): { name: string; explanation: string; influence: string; calculation: string } | null {
    const explanations: { [key: string]: { name: string; explanation: string; influence: string; calculation: string } } = {
      '旺': {
        name: '旺',
        explanation: '日主旺表示命主的五行力量强盛，个性刚强，自信心强，有领导能力，但可能过于自信或固执。',
        influence: '日主旺的人，性格刚强，自信心强，有领导能力，做事果断，但可能过于自信或固执，不易接受他人意见。',
        calculation: `日主旺衰计算方法：

【基础计算】
1. 计算日主五行在八字中的强度
   - 首先确定日主五行（日干所属五行）
   - 计算该五行在八字中的总得分（按照五行强度计算方法）
   - 计算所有五行的总得分
   - 计算日主五行的相对强度：日主五行得分/所有五行总得分

【季节影响】
2. 考虑季节对日主五行的影响：
   - 春季（正、二、三月）：
     * 木旺(+0.3)、火相(+0.15)、土休(0)、金囚(-0.15)、水死(-0.3)
   - 夏季（四、五、六月）：
     * 火旺(+0.3)、土相(+0.15)、金休(0)、水囚(-0.15)、木死(-0.3)
   - 秋季（七、八、九月）：
     * 金旺(+0.3)、水相(+0.15)、木休(0)、火囚(-0.15)、土死(-0.3)
   - 冬季（十、十一、十二月）：
     * 水旺(+0.3)、木相(+0.15)、火休(0)、土囚(-0.15)、金死(-0.3)

【生克关系】
3. 考虑月支对日主的生克关系
   - 月支五行生日主：+0.2
   - 月支五行克日主：-0.2
   - 日主五行克月支：+0.1
   - 日主五行生月支：-0.1

【组合影响】
4. 考虑地支三合局对日主的影响
   - 三合局五行生日主：+0.15
   - 三合局五行克日主：-0.15
   - 日主五行克三合局：+0.1
   - 日主五行生三合局：-0.1

5. 考虑天干五合对日主的影响
   - 五合化五行生日主：+0.1
   - 五合化五行克日主：-0.1
   - 日主参与五合：-0.05（日主受牵制）

6. 考虑纳音五行对日主的影响
   - 日柱纳音与日主五行相同：+0.1
   - 日柱纳音生日主五行：+0.05
   - 日柱纳音克日主五行：-0.05

【计算示例】
假设八字为：甲子 乙丑 丙寅 丁卯
- 日主为丙火
- 月令为丑月（冬季）
- 日主五行强度计算：丙火得分为3.5分，总分为20分，相对强度为0.175
- 季节影响：冬季火休，调整系数为0
- 月支丑土克火：-0.2
- 地支三合：子、丑可能与辰形成三合水局，水克火：-0.15
- 天干五合：无
- 纳音五行：丙寅为炉中火，与日主同类：+0.1

最终得分：0.175 + 0 - 0.2 - 0.15 + 0.1 = -0.075

【旺衰判定】
7. 归一化得分，计算最终旺衰状态：
   - 旺：得分 > 0.6
   - 相：0.3 < 得分 ≤ 0.6
   - 休：-0.3 ≤ 得分 ≤ 0.3
   - 囚：-0.6 ≤ 得分 < -0.3
   - 死：得分 < -0.6

根据计算结果-0.075，日主为"休"。`
      },
      '相': {
        name: '相',
        explanation: '日主相表示命主的五行力量较强，性格较为平衡，有自信但不过分，能够适应各种环境。',
        influence: '日主相的人，性格较为平衡，有自信但不过分，能够适应各种环境，做事有主见但也能接受他人意见。',
        calculation: `日主旺衰计算方法：

【基础计算】
1. 计算日主五行在八字中的强度
   - 首先确定日主五行（日干所属五行）
   - 计算该五行在八字中的总得分（按照五行强度计算方法）
   - 计算所有五行的总得分
   - 计算日主五行的相对强度：日主五行得分/所有五行总得分

【季节影响】
2. 考虑季节对日主五行的影响：
   - 春季（正、二、三月）：
     * 木旺(+0.3)、火相(+0.15)、土休(0)、金囚(-0.15)、水死(-0.3)
   - 夏季（四、五、六月）：
     * 火旺(+0.3)、土相(+0.15)、金休(0)、水囚(-0.15)、木死(-0.3)
   - 秋季（七、八、九月）：
     * 金旺(+0.3)、水相(+0.15)、木休(0)、火囚(-0.15)、土死(-0.3)
   - 冬季（十、十一、十二月）：
     * 水旺(+0.3)、木相(+0.15)、火休(0)、土囚(-0.15)、金死(-0.3)

【生克关系】
3. 考虑月支对日主的生克关系
   - 月支五行生日主：+0.2
   - 月支五行克日主：-0.2
   - 日主五行克月支：+0.1
   - 日主五行生月支：-0.1

【组合影响】
4. 考虑地支三合局对日主的影响
   - 三合局五行生日主：+0.15
   - 三合局五行克日主：-0.15
   - 日主五行克三合局：+0.1
   - 日主五行生三合局：-0.1

5. 考虑天干五合对日主的影响
   - 五合化五行生日主：+0.1
   - 五合化五行克日主：-0.1
   - 日主参与五合：-0.05（日主受牵制）

6. 考虑纳音五行对日主的影响
   - 日柱纳音与日主五行相同：+0.1
   - 日柱纳音生日主五行：+0.05
   - 日柱纳音克日主五行：-0.05

【计算示例】
假设八字为：甲子 乙丑 戊午 己未
- 日主为戊土
- 月令为丑月（冬季）
- 日主五行强度计算：戊土得分为5.5分，总分为22分，相对强度为0.25
- 季节影响：冬季土囚，调整系数为-0.15
- 月支丑土生土：+0.2
- 地支三合：无明显三合
- 天干五合：无
- 纳音五行：戊午为天上火，火生土：+0.05

最终得分：0.25 - 0.15 + 0.2 + 0.05 = 0.35

【旺衰判定】
7. 归一化得分，计算最终旺衰状态：
   - 旺：得分 > 0.6
   - 相：0.3 < 得分 ≤ 0.6
   - 休：-0.3 ≤ 得分 ≤ 0.3
   - 囚：-0.6 ≤ 得分 < -0.3
   - 死：得分 < -0.6

根据计算结果0.35，日主为"相"。`
      },
      '休': {
        name: '休',
        explanation: '日主休表示命主的五行力量适中偏弱，性格温和，适应力强，但可能缺乏主见或决断力。',
        influence: '日主休的人，性格温和，适应力强，能够融入各种环境，但可能缺乏主见或决断力，容易受他人影响。',
        calculation: `日主旺衰计算方法：

【基础计算】
1. 计算日主五行在八字中的强度
   - 首先确定日主五行（日干所属五行）
   - 计算该五行在八字中的总得分（按照五行强度计算方法）
   - 计算所有五行的总得分
   - 计算日主五行的相对强度：日主五行得分/所有五行总得分

【季节影响】
2. 考虑季节对日主五行的影响：
   - 春季（正、二、三月）：
     * 木旺(+0.3)、火相(+0.15)、土休(0)、金囚(-0.15)、水死(-0.3)
   - 夏季（四、五、六月）：
     * 火旺(+0.3)、土相(+0.15)、金休(0)、水囚(-0.15)、木死(-0.3)
   - 秋季（七、八、九月）：
     * 金旺(+0.3)、水相(+0.15)、木休(0)、火囚(-0.15)、土死(-0.3)
   - 冬季（十、十一、十二月）：
     * 水旺(+0.3)、木相(+0.15)、火休(0)、土囚(-0.15)、金死(-0.3)

【生克关系】
3. 考虑月支对日主的生克关系
   - 月支五行生日主：+0.2
   - 月支五行克日主：-0.2
   - 日主五行克月支：+0.1
   - 日主五行生月支：-0.1

【组合影响】
4. 考虑地支三合局对日主的影响
   - 三合局五行生日主：+0.15
   - 三合局五行克日主：-0.15
   - 日主五行克三合局：+0.1
   - 日主五行生三合局：-0.1

5. 考虑天干五合对日主的影响
   - 五合化五行生日主：+0.1
   - 五合化五行克日主：-0.1
   - 日主参与五合：-0.05（日主受牵制）

6. 考虑纳音五行对日主的影响
   - 日柱纳音与日主五行相同：+0.1
   - 日柱纳音生日主五行：+0.05
   - 日柱纳音克日主五行：-0.05

【计算示例】
假设八字为：丙子 丁丑 戊寅 己卯
- 日主为戊土
- 月令为丑月（冬季）
- 日主五行强度计算：戊土得分为4.0分，总分为20分，相对强度为0.2
- 季节影响：冬季土囚，调整系数为-0.15
- 月支丑土生土：+0.2
- 地支三合：寅卯可能与未形成三合木局，木克土：-0.15
- 天干五合：无
- 纳音五行：戊寅为城墙土，与日主同类：+0.1

最终得分：0.2 - 0.15 + 0.2 - 0.15 + 0.1 = 0.2

【旺衰判定】
7. 归一化得分，计算最终旺衰状态：
   - 旺：得分 > 0.6
   - 相：0.3 < 得分 ≤ 0.6
   - 休：-0.3 ≤ 得分 ≤ 0.3
   - 囚：-0.6 ≤ 得分 < -0.3
   - 死：得分 < -0.6

根据计算结果0.2，日主为"休"。`
      },
      '囚': {
        name: '囚',
        explanation: '日主囚表示命主的五行力量较弱，个性较为内向，自信心不足，容易受外界影响。',
        influence: '日主囚的人，个性较为内向，自信心不足，容易受外界影响，做事缺乏主见，但为人谦和，善于倾听。',
        calculation: `日主旺衰计算方法：

【基础计算】
1. 计算日主五行在八字中的强度
   - 首先确定日主五行（日干所属五行）
   - 计算该五行在八字中的总得分（按照五行强度计算方法）
   - 计算所有五行的总得分
   - 计算日主五行的相对强度：日主五行得分/所有五行总得分

【季节影响】
2. 考虑季节对日主五行的影响：
   - 春季（正、二、三月）：
     * 木旺(+0.3)、火相(+0.15)、土休(0)、金囚(-0.15)、水死(-0.3)
   - 夏季（四、五、六月）：
     * 火旺(+0.3)、土相(+0.15)、金休(0)、水囚(-0.15)、木死(-0.3)
   - 秋季（七、八、九月）：
     * 金旺(+0.3)、水相(+0.15)、木休(0)、火囚(-0.15)、土死(-0.3)
   - 冬季（十、十一、十二月）：
     * 水旺(+0.3)、木相(+0.15)、火休(0)、土囚(-0.15)、金死(-0.3)

【生克关系】
3. 考虑月支对日主的生克关系
   - 月支五行生日主：+0.2
   - 月支五行克日主：-0.2
   - 日主五行克月支：+0.1
   - 日主五行生月支：-0.1

【组合影响】
4. 考虑地支三合局对日主的影响
   - 三合局五行生日主：+0.15
   - 三合局五行克日主：-0.15
   - 日主五行克三合局：+0.1
   - 日主五行生三合局：-0.1

5. 考虑天干五合对日主的影响
   - 五合化五行生日主：+0.1
   - 五合化五行克日主：-0.1
   - 日主参与五合：-0.05（日主受牵制）

6. 考虑纳音五行对日主的影响
   - 日柱纳音与日主五行相同：+0.1
   - 日柱纳音生日主五行：+0.05
   - 日柱纳音克日主五行：-0.05

【计算示例】
假设八字为：甲子 乙丑 丙寅 丁卯
- 日主为丙火
- 月令为丑月（冬季）
- 日主五行强度计算：丙火得分为2.5分，总分为20分，相对强度为0.125
- 季节影响：冬季火囚，调整系数为-0.15
- 月支丑土克火：-0.2
- 地支三合：寅卯可能与未形成三合木局，木生火：+0.15
- 天干五合：无
- 纳音五行：丙寅为炉中火，与日主同类：+0.1

最终得分：0.125 - 0.15 - 0.2 + 0.15 + 0.1 = -0.475

【旺衰判定】
7. 归一化得分，计算最终旺衰状态：
   - 旺：得分 > 0.6
   - 相：0.3 < 得分 ≤ 0.6
   - 休：-0.3 ≤ 得分 ≤ 0.3
   - 囚：-0.6 ≤ 得分 < -0.3
   - 死：得分 < -0.6

根据计算结果-0.475，日主为"囚"。`
      },
      '死': {
        name: '死',
        explanation: '日主死表示命主的五行力量极弱，个性可能过于软弱，缺乏自信，容易受制于人。',
        influence: '日主死的人，个性可能过于软弱，缺乏自信，容易受制于人，做事缺乏主见，但为人谦和，善于倾听，适合辅助性工作。',
        calculation: `日主旺衰计算方法：

【基础计算】
1. 计算日主五行在八字中的强度
   - 首先确定日主五行（日干所属五行）
   - 计算该五行在八字中的总得分（按照五行强度计算方法）
   - 计算所有五行的总得分
   - 计算日主五行的相对强度：日主五行得分/所有五行总得分

【季节影响】
2. 考虑季节对日主五行的影响：
   - 春季（正、二、三月）：
     * 木旺(+0.3)、火相(+0.15)、土休(0)、金囚(-0.15)、水死(-0.3)
   - 夏季（四、五、六月）：
     * 火旺(+0.3)、土相(+0.15)、金休(0)、水囚(-0.15)、木死(-0.3)
   - 秋季（七、八、九月）：
     * 金旺(+0.3)、水相(+0.15)、木休(0)、火囚(-0.15)、土死(-0.3)
   - 冬季（十、十一、十二月）：
     * 水旺(+0.3)、木相(+0.15)、火休(0)、土囚(-0.15)、金死(-0.3)

【生克关系】
3. 考虑月支对日主的生克关系
   - 月支五行生日主：+0.2
   - 月支五行克日主：-0.2
   - 日主五行克月支：+0.1
   - 日主五行生月支：-0.1

【组合影响】
4. 考虑地支三合局对日主的影响
   - 三合局五行生日主：+0.15
   - 三合局五行克日主：-0.15
   - 日主五行克三合局：+0.1
   - 日主五行生三合局：-0.1

5. 考虑天干五合对日主的影响
   - 五合化五行生日主：+0.1
   - 五合化五行克日主：-0.1
   - 日主参与五合：-0.05（日主受牵制）

6. 考虑纳音五行对日主的影响
   - 日柱纳音与日主五行相同：+0.1
   - 日柱纳音生日主五行：+0.05
   - 日柱纳音克日主五行：-0.05

【计算示例】
假设八字为：壬子 癸丑 甲寅 乙卯
- 日主为甲木
- 月令为丑月（冬季）
- 日主五行强度计算：甲木得分为1.5分，总分为25分，相对强度为0.06
- 季节影响：冬季木相，调整系数为+0.15
- 月支丑土克木：-0.2
- 地支三合：子丑可能与辰形成三合水局，水生木：+0.15
- 天干五合：无
- 纳音五行：甲寅为大溪水，水生木：+0.05

最终得分：0.06 + 0.15 - 0.2 + 0.15 + 0.05 = -0.79

【旺衰判定】
7. 归一化得分，计算最终旺衰状态：
   - 旺：得分 > 0.6
   - 相：0.3 < 得分 ≤ 0.6
   - 休：-0.3 ≤ 得分 ≤ 0.3
   - 囚：-0.6 ≤ 得分 < -0.3
   - 死：得分 < -0.6

根据计算结果-0.79，日主为"死"。`
      }
    };

    return explanations[riZhu] || null;
  }
}
